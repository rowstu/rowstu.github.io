<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>VMware NSX // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>VMware NSX</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/vmwarensx_notes/>Vmwarensx_notes</a></div><div class="card markdown-content"><p>VMware NSX is a <strong>software-defined networking (SDN)</strong> platform that virtualizes network functions and security services, enabling network automation, micro-segmentation, and scalable network operations inside virtualized environments.</p><h3 id=core-value><strong>Core Value</strong></h3><ul><li><strong>Network abstraction</strong>: decouples network services from physical hardware</li><li><strong>Consistent security</strong>: micro-segmentation and policy-driven security</li><li><strong>Automation & agility</strong>: integrate networking into CI/CD workflows</li><li><strong>Operational efficiency</strong>: reduce time to deploy networks from days to minutes</li></ul><h3 id=nsx-components-high-level><strong>NSX Components (High Level)</strong></h3><table><thead><tr><th>Component</th><th>Role</th></tr></thead><tbody><tr><td><strong>NSX Manager</strong></td><td>Central control plane and API endpoint</td></tr><tr><td><strong>NSX Controllers</strong></td><td>Control plane (distributed routing, etc.) <em>(NSX-T handles this differently)</em></td></tr><tr><td><strong>NSX Edge</strong></td><td>North-South routing, load balancing, VPN, NAT</td></tr><tr><td><strong>NSX Distributed Firewall (DFW)</strong></td><td>Micro-segmentation security engine</td></tr><tr><td><strong>NSX Data Plane (VIB/VXLAN)</strong></td><td>Packet forwarding and overlay encapsulation</td></tr></tbody></table><h3 id=nsx-editions><strong>NSX Editions</strong></h3><ul><li><strong>NSX Data Center</strong> (traditional)</li><li><strong>NSX-T Data Center</strong> (multi-hypervisor, Kubernetes, public cloud integration)</li><li><strong>NSX Advanced Threat Prevention / NSX Intelligence</strong> (analytics + threat detection)</li></ul><hr><h2 id=nsx-architecture-overview><strong>NSX Architecture Overview</strong></h2><h3 id=nsx-t-modern-standard><strong>NSX-T (Modern Standard)</strong></h3><p>NSX-T is the modern standard for NSX deployments.</p><h4 id=control-plane><strong>Control Plane</strong></h4><ul><li>Distributed across NSX Managers</li><li>Handles routing, policy, and state</li></ul><h4 id=data-plane><strong>Data Plane</strong></h4><ul><li>Runs on ESXi or KVM hosts</li><li>Uses <strong>Geneve</strong> encapsulation</li></ul><h4 id=management-plane><strong>Management Plane</strong></h4><ul><li>NSX Manager cluster</li><li>Provides UI, REST API, and integration endpoints</li></ul><h3 id=key-architectural-features><strong>Key Architectural Features</strong></h3><ul><li><strong>Overlay networking</strong> (Geneve / VXLAN)</li><li><strong>Distributed routing</strong></li><li><strong>Service insertion</strong> (firewalls, IDS/IPS, WAF)</li><li><strong>Micro-segmentation</strong></li><li><strong>East-West traffic security</strong></li><li><strong>Edge gateways for North-South traffic</strong></li></ul><hr><h2 id=installation--configuration-step-by-step><strong>Installation & Configuration (Step-by-Step)</strong></h2><h3 id=prerequisites><strong>Prerequisites</strong></h3><ul><li>vCenter + ESXi (for NSX-V or NSX-T)</li><li>DNS entries for NSX Manager and controllers</li><li>NTP configured on all nodes</li><li>IP address plan for management, overlay, and edge nodes</li><li>Proper MTU settings (recommended 1600+)</li></ul><hr><h3 id=a-deploy-nsx-manager-nsx-t><strong>A. Deploy NSX Manager (NSX-T)</strong></h3><p><strong>Step 1: Deploy OVA</strong></p><ul><li><p>Deploy NSX Manager OVA from VMware download portal</p></li><li><p>Configure:</p><ul><li>IP address</li><li>Hostname</li><li>DNS</li><li>NTP</li><li>Admin password</li></ul></li></ul><p><strong>Step 2: Create NSX Manager Cluster</strong></p><ul><li>Add 3 NSX Managers for HA</li><li>Wait for cluster synchronization</li></ul><p><strong>Step 3: Configure NSX Manager</strong></p><ul><li>Configure SSO integration with vCenter (optional)</li><li>Configure LDAP (optional)</li><li>Generate API tokens for automation</li></ul><hr><h3 id=b-register-nsx-with-vcenter><strong>B. Register NSX with vCenter</strong></h3><p><strong>Step 1: Add vCenter</strong></p><ul><li>NSX Manager → System → Fabric → Compute Managers</li><li>Add vCenter Server credentials</li></ul><p><strong>Step 2: Install NSX VIBs on ESXi</strong></p><ul><li>Automatically installed via NSX Manager</li><li>Ensure all hosts show “NSX Installed”</li></ul><hr><h3 id=c-configure-transport-zones><strong>C. Configure Transport Zones</strong></h3><p>Transport zones define which hosts can communicate in an overlay.</p><ul><li><strong>Overlay TZ</strong> for VM-to-VM communication</li><li><strong>VLAN TZ</strong> for physical network access</li></ul><hr><h3 id=d-create-segments-logical-switches><strong>D. Create Segments (Logical Switches)</strong></h3><p>Segments are NSX-T’s logical networks.</p><ul><li>Create segment</li><li>Attach to transport zone</li><li>Assign gateway IP</li></ul><hr><h3 id=e-configure-tier-0-and-tier-1-gateways><strong>E. Configure Tier-0 and Tier-1 Gateways</strong></h3><p><strong>Tier-0 (Edge)</strong></p><ul><li>North-South routing</li><li>BGP/OSPF</li><li>NAT</li></ul><p><strong>Tier-1</strong></p><ul><li>East-West routing</li><li>Connects to Tier-0</li><li>Connects to segments</li></ul><hr><h3 id=f-deploy-nsx-edge-nodes><strong>F. Deploy NSX Edge Nodes</strong></h3><p>Edge nodes provide:</p><ul><li>North-South routing</li><li>Load balancing</li><li>VPN</li></ul><p><strong>Steps</strong></p><ul><li>Deploy Edge OVA</li><li>Add Edge node to NSX Manager</li><li>Configure Edge Cluster</li></ul><hr><h3 id=g-distributed-firewall-dfw-setup><strong>G. Distributed Firewall (DFW) Setup</strong></h3><ul><li>Define security policies by tags</li><li>Use security groups</li><li>Apply micro-segmentation</li></ul><hr><h2 id=networking-fundamentals><strong>Networking Fundamentals</strong></h2><h3 id=overlay-networking><strong>Overlay Networking</strong></h3><ul><li>Encapsulates traffic in <strong>Geneve</strong> tunnels</li><li>Allows L2 networks over L3 underlay</li></ul><h3 id=underlay-requirements><strong>Underlay Requirements</strong></h3><ul><li>Proper IP routing</li><li>MTU 1600+ recommended</li><li>Multicast not required in NSX-T</li></ul><h3 id=routing><strong>Routing</strong></h3><ul><li><strong>Distributed Routing</strong>: runs on hypervisors</li><li><strong>Edge Routing</strong>: for North-South</li></ul><h3 id=security><strong>Security</strong></h3><ul><li><strong>Micro-segmentation</strong> with DFW</li><li>Security groups based on VM tags</li><li>Service insertion for third-party firewalls</li></ul><hr><h2 id=deployment-scenarios><strong>Deployment Scenarios</strong></h2><h3 id=a-data-center-transformation><strong>A. Data Center Transformation</strong></h3><p><strong>Goal</strong>: Move from physical VLAN networks to overlay networks.</p><p><strong>Use Case</strong></p><ul><li>Migrate from VLAN-based networking to NSX overlays</li><li>Reduce physical dependency</li><li>Speed up VM provisioning</li></ul><p><strong>Real-World Example</strong></p><ul><li>A 1-week provisioning task becomes a 1-hour automated process</li></ul><hr><h3 id=b-micro-segmentation><strong>B. Micro-segmentation</strong></h3><p><strong>Goal</strong>: Reduce attack surface within the data center.</p><p><strong>Example Policy</strong></p><ul><li>DB servers only accept traffic from App servers</li><li>No inbound traffic from general user VMs</li></ul><p><strong>Best Practice</strong></p><ul><li>Start with <strong>Allow-All</strong>, then progressively tighten policies.</li></ul><hr><h3 id=c-multi-cloud--hybrid-cloud><strong>C. Multi-Cloud / Hybrid Cloud</strong></h3><p>NSX-T can integrate with:</p><ul><li>AWS</li><li>Azure</li><li>VMware Cloud on AWS</li><li>Kubernetes (NSX-T CNI)</li></ul><hr><h3 id=d-service-insertion><strong>D. Service Insertion</strong></h3><p>Insert third-party services:</p><ul><li>IDS/IPS</li><li>WAF</li><li>Advanced firewalls</li></ul><hr><h2 id=monitoring--troubleshooting><strong>Monitoring & Troubleshooting</strong></h2><h3 id=best-practices><strong>Best Practices</strong></h3><ul><li>Monitor using <strong>NSX Intelligence</strong></li><li>Enable syslog export to SIEM</li><li>Track overlay tunnel health</li></ul><h3 id=common-tools><strong>Common Tools</strong></h3><ul><li>NSX Manager UI</li><li>CLI on NSX Manager</li><li>NSX API</li><li>vSphere logs</li><li>vRealize Log Insight</li></ul><h3 id=troubleshooting-workflow><strong>Troubleshooting Workflow</strong></h3><ol><li><strong>Check NSX Manager health</strong></li><li><strong>Validate control plane status</strong></li><li><strong>Check overlay tunnel status</strong></li><li><strong>Verify DFW rules</strong></li><li><strong>Check Edge routing</strong></li><li><strong>Validate host VIBs</strong></li></ol><h3 id=useful-commands><strong>Useful Commands</strong></h3><ul><li><code>get logical-router</code></li><li><code>get edge-cluster</code></li><li><code>get transport-node</code></li><li><code>get service</code></li></ul><hr><h2 id=upgrades--updates-without-downtime><strong>Upgrades & Updates (Without Downtime)</strong></h2><h3 id=best-practices-1><strong>Best Practices</strong></h3><ul><li><p>Use <strong>staged upgrades</strong></p></li><li><p>Always upgrade:</p><ol><li>NSX Manager</li><li>Edge nodes</li><li>Transport nodes</li><li>DFW & policies</li></ol></li><li><p>Always backup NSX configuration before upgrade</p></li></ul><h3 id=recommended-strategy><strong>Recommended Strategy</strong></h3><ul><li>Upgrade one NSX Manager at a time (if clustered)</li><li>Upgrade one Edge node at a time</li><li>Ensure DRS and HA are enabled in vSphere</li></ul><h3 id=maintenance-window><strong>Maintenance Window</strong></h3><ul><li>Plan during off-peak</li><li>Use rolling upgrades</li></ul><hr><h2 id=security-best-practices><strong>Security Best Practices</strong></h2><h3 id=1-micro-segmentation><strong>1. Micro-Segmentation</strong></h3><ul><li>Start with coarse policies</li><li>Refine over time</li><li>Use Security Groups + Tags</li></ul><h3 id=2-limit-nsx-manager-access><strong>2. Limit NSX Manager Access</strong></h3><ul><li>Use RBAC</li><li>Restrict admin access</li><li>Enable MFA where possible</li></ul><h3 id=3-secure-management-plane><strong>3. Secure Management Plane</strong></h3><ul><li>Use TLS</li><li>Ensure DNS integrity</li><li>Use dedicated management network</li></ul><h3 id=4-enable-logging--audit><strong>4. Enable Logging & Audit</strong></h3><ul><li>Centralize logs (SIEM)</li><li>Audit policy changes</li><li>Track user access</li></ul><h3 id=5-harden-edge-nodes><strong>5. Harden Edge Nodes</strong></h3><ul><li>Limit services</li><li>Ensure firewall rules</li><li>Patch regularly</li></ul><hr><h2 id=integration-with-other-tools><strong>Integration with Other Tools</strong></h2><h3 id=a-vmware-vrealize-suite><strong>A. VMware vRealize Suite</strong></h3><ul><li>vRealize Automation (network automation)</li><li>vRealize Operations (monitoring)</li><li>vRealize Log Insight (log analytics)</li></ul><h3 id=b-kubernetes><strong>B. Kubernetes</strong></h3><p>NSX-T provides:</p><ul><li>NSX-T CNI for Kubernetes networking</li><li>Network policies and micro-segmentation for pods</li></ul><h3 id=c-public-cloud><strong>C. Public Cloud</strong></h3><p>NSX-T can integrate with:</p><ul><li>AWS Transit Gateway</li><li>Azure VNet</li><li>VMware Cloud on AWS</li></ul><h3 id=d-third-party-security-tools><strong>D. Third-Party Security Tools</strong></h3><ul><li>Palo Alto, Fortinet, Check Point (service insertion)</li><li>SIEM tools for logging</li></ul></div></div><script src=/assets/shared-nav.js></script></body></html>