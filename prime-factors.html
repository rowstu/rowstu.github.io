<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Prime Factorisation // rowstu.net</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #1a1d23;
			--surface: #252932;
			--surface-hover: #2d323d;
			--border: #3d4351;
			--text: #e4e7eb;
			--text-muted: #9ca3af;
			--accent: #10b981;
			--accent-hover: #059669;
			--warning: #f59e0b;
			--info: #3b82f6;
			--purple: #a78bfa;
			--pink: #f472b6;
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }

		body {
			font-family: 'IBM Plex Mono', monospace;
			background: var(--bg);
			color: var(--text);
			min-height: 100vh;
			padding: 1.5rem;
		}

		.container { max-width: 700px; margin: 0 auto; }

		header { margin-bottom: 1.5rem; }

		h1 {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.subtitle { color: var(--text-muted); font-size: 0.875rem; }

		.panel {
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 8px;
			padding: 1.25rem;
			margin-bottom: 1rem;
		}

		.panel-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.panel-title {
			font-size: 0.875rem;
			font-weight: 500;
			color: var(--text-muted);
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}

		.input-row {
			display: flex;
			gap: 0.5rem;
			align-items: center;
			flex-wrap: wrap;
		}

		input[type="number"] {
			background: var(--bg);
			border: 1px solid var(--border);
			border-radius: 4px;
			padding: 0.6rem 0.75rem;
			color: var(--text);
			font-family: inherit;
			font-size: 1rem;
			width: 150px;
			outline: none;
		}

		input[type="number"]:focus {
			border-color: var(--accent);
		}

		.btn {
			background: var(--accent);
			border: none;
			color: #fff;
			padding: 0.6rem 1rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.85rem;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.btn:hover {
			background: var(--accent-hover);
		}

		.examples {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
			margin-top: 0.75rem;
		}

		.example-btn {
			background: var(--surface-hover);
			border: 1px solid var(--border);
			color: var(--text);
			padding: 0.35rem 0.6rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.75rem;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.example-btn:hover {
			border-color: var(--accent);
			color: var(--accent);
		}

		.result-section {
			background: var(--bg);
			border-radius: 6px;
			padding: 1rem;
			margin-bottom: 1rem;
		}

		.result-section:last-child {
			margin-bottom: 0;
		}

		.result-label {
			font-size: 0.8rem;
			color: var(--text-muted);
			text-transform: uppercase;
			margin-bottom: 0.5rem;
		}

		.result-value {
			font-size: 1.2rem;
			font-weight: 600;
			color: var(--accent);
		}

		.prime-badge {
			display: inline-block;
			background: rgba(16, 185, 129, 0.2);
			color: var(--accent);
			padding: 0.25rem 0.75rem;
			border-radius: 4px;
			font-size: 0.85rem;
			font-weight: 600;
		}

		.factors-display {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
			align-items: center;
		}

		.factor {
			display: inline-flex;
			align-items: baseline;
			background: var(--surface);
			padding: 0.35rem 0.6rem;
			border-radius: 4px;
		}

		.factor-base {
			font-size: 1.1rem;
			font-weight: 600;
			color: var(--warning);
		}

		.factor-exp {
			font-size: 0.75rem;
			font-weight: 600;
			color: var(--info);
			vertical-align: super;
			margin-left: 1px;
		}

		.multiply {
			color: var(--text-muted);
			font-size: 1rem;
		}

		.tree-container {
			background: var(--surface);
			border-radius: 4px;
			padding: 1rem;
			overflow-x: auto;
		}

		.tree-step {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			padding: 0.35rem 0;
			border-bottom: 1px solid var(--border);
		}

		.tree-step:last-child {
			border-bottom: none;
		}

		.tree-number {
			min-width: 80px;
			text-align: right;
			color: var(--text);
		}

		.tree-divisor {
			color: var(--warning);
			font-weight: 600;
		}

		.tree-arrow {
			color: var(--text-muted);
		}

		.tree-result {
			color: var(--accent);
		}

		.divisors-grid {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
		}

		.divisor {
			background: var(--surface);
			padding: 0.35rem 0.6rem;
			border-radius: 4px;
			font-size: 0.9rem;
		}

		.divisor.prime {
			color: var(--warning);
			font-weight: 500;
		}

		.info-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
			gap: 0.5rem;
			margin-top: 0.5rem;
		}

		.info-item {
			background: var(--surface);
			padding: 0.5rem;
			border-radius: 4px;
			text-align: center;
		}

		.info-label {
			font-size: 0.7rem;
			color: var(--text-muted);
		}

		.info-value {
			font-size: 1rem;
			font-weight: 600;
			color: var(--purple);
		}

		.primes-list {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
		}

		.prime-num {
			background: var(--bg);
			padding: 0.3rem 0.5rem;
			border-radius: 4px;
			font-size: 0.8rem;
			color: var(--warning);
		}
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>Prime Factorisation</h1>
			<p class="subtitle">Break numbers into prime factors with step-by-step working</p>
		</header>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">Enter Number</span>
			</div>
			<div class="input-row">
				<input type="number" id="numberInput" placeholder="e.g., 360" value="360" min="2" max="999999999">
				<button class="btn" onclick="factorise()">Factorise</button>
			</div>
			<div class="examples">
				<span style="color: var(--text-muted); font-size: 0.75rem;">Try:</span>
				<button class="example-btn" onclick="setNumber(12)">12</button>
				<button class="example-btn" onclick="setNumber(60)">60</button>
				<button class="example-btn" onclick="setNumber(100)">100</button>
				<button class="example-btn" onclick="setNumber(360)">360</button>
				<button class="example-btn" onclick="setNumber(1024)">1024</button>
				<button class="example-btn" onclick="setNumber(9973)">9973</button>
				<button class="example-btn" onclick="setNumber(123456)">123456</button>
			</div>
		</div>

		<div class="panel" id="resultsPanel" style="display: none;">
			<div class="panel-header">
				<span class="panel-title">Results</span>
			</div>
			<div id="results"></div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">First 50 Prime Numbers</span>
			</div>
			<div class="primes-list" id="primesList"></div>
		</div>
	</div>

	<script>
		const numberInput = document.getElementById('numberInput');
		const resultsPanel = document.getElementById('resultsPanel');
		const resultsDiv = document.getElementById('results');

		numberInput.addEventListener('keydown', e => {
			if (e.key === 'Enter') factorise();
		});

		function setNumber(n) {
			numberInput.value = n;
			factorise();
		}

		function isPrime(n) {
			if (n < 2) return false;
			if (n === 2) return true;
			if (n % 2 === 0) return false;
			for (let i = 3; i <= Math.sqrt(n); i += 2) {
				if (n % i === 0) return false;
			}
			return true;
		}

		function getPrimeFactors(n) {
			const factors = {};
			const steps = [];
			let current = n;

			// Check for 2
			while (current % 2 === 0) {
				factors[2] = (factors[2] || 0) + 1;
				steps.push({ number: current, divisor: 2, result: current / 2 });
				current = current / 2;
			}

			// Check odd numbers
			for (let i = 3; i <= Math.sqrt(current); i += 2) {
				while (current % i === 0) {
					factors[i] = (factors[i] || 0) + 1;
					steps.push({ number: current, divisor: i, result: current / i });
					current = current / i;
				}
			}

			// If remaining is prime > 2
			if (current > 2) {
				factors[current] = (factors[current] || 0) + 1;
				steps.push({ number: current, divisor: current, result: 1 });
			}

			return { factors, steps };
		}

		function getAllDivisors(n) {
			const divisors = [];
			for (let i = 1; i <= Math.sqrt(n); i++) {
				if (n % i === 0) {
					divisors.push(i);
					if (i !== n / i) {
						divisors.push(n / i);
					}
				}
			}
			return divisors.sort((a, b) => a - b);
		}

		function factorise() {
			const n = parseInt(numberInput.value);

			if (isNaN(n) || n < 2) {
				resultsDiv.innerHTML = '<div class="result-section"><div class="result-value" style="color: var(--warning);">Please enter a number ≥ 2</div></div>';
				resultsPanel.style.display = 'block';
				return;
			}

			if (n > 999999999) {
				resultsDiv.innerHTML = '<div class="result-section"><div class="result-value" style="color: var(--warning);">Number too large (max: 999,999,999)</div></div>';
				resultsPanel.style.display = 'block';
				return;
			}

			// Check if prime
			if (isPrime(n)) {
				resultsDiv.innerHTML = `
					<div class="result-section">
						<div class="result-label">Result</div>
						<div class="prime-badge">${n.toLocaleString()} is PRIME</div>
					</div>
					<div class="result-section">
						<div class="result-label">Divisors</div>
						<div class="divisors-grid">
							<span class="divisor">1</span>
							<span class="divisor prime">${n.toLocaleString()}</span>
						</div>
					</div>`;
				resultsPanel.style.display = 'block';
				return;
			}

			const { factors, steps } = getPrimeFactors(n);
			const divisors = getAllDivisors(n);

			// Build factors display
			const factorEntries = Object.entries(factors);
			const factorsHtml = factorEntries.map(([base, exp], i) => {
				const multiply = i < factorEntries.length - 1 ? '<span class="multiply">×</span>' : '';
				if (exp === 1) {
					return `<span class="factor"><span class="factor-base">${base}</span></span>${multiply}`;
				}
				return `<span class="factor"><span class="factor-base">${base}</span><span class="factor-exp">${exp}</span></span>${multiply}`;
			}).join('');

			// Expanded form
			const expandedFactors = [];
			for (const [base, exp] of factorEntries) {
				for (let i = 0; i < exp; i++) {
					expandedFactors.push(base);
				}
			}
			const expandedHtml = expandedFactors.join(' × ');

			// Steps
			const stepsHtml = steps.map(s => `
				<div class="tree-step">
					<span class="tree-number">${s.number.toLocaleString()}</span>
					<span class="tree-arrow">÷</span>
					<span class="tree-divisor">${s.divisor}</span>
					<span class="tree-arrow">=</span>
					<span class="tree-result">${s.result.toLocaleString()}</span>
				</div>
			`).join('');

			// Divisors
			const divisorsHtml = divisors.map(d => {
				const primeClass = isPrime(d) && d > 1 ? 'prime' : '';
				return `<span class="divisor ${primeClass}">${d.toLocaleString()}</span>`;
			}).join('');

			// Unique prime factors
			const uniquePrimes = Object.keys(factors).map(Number);

			resultsDiv.innerHTML = `
				<div class="result-section">
					<div class="result-label">Prime Factorisation</div>
					<div class="result-value">${n.toLocaleString()} =</div>
					<div class="factors-display" style="margin-top: 0.5rem;">${factorsHtml}</div>
				</div>

				<div class="result-section">
					<div class="result-label">Expanded Form</div>
					<div style="font-size: 0.95rem; color: var(--text);">${expandedHtml}</div>
				</div>

				<div class="result-section">
					<div class="result-label">Division Steps</div>
					<div class="tree-container">${stepsHtml}</div>
				</div>

				<div class="result-section">
					<div class="result-label">All Divisors (${divisors.length})</div>
					<div class="divisors-grid">${divisorsHtml}</div>
				</div>

				<div class="result-section">
					<div class="result-label">Properties</div>
					<div class="info-grid">
						<div class="info-item">
							<div class="info-label">Unique Primes</div>
							<div class="info-value">${uniquePrimes.length}</div>
						</div>
						<div class="info-item">
							<div class="info-label">Total Divisors</div>
							<div class="info-value">${divisors.length}</div>
						</div>
						<div class="info-item">
							<div class="info-label">Sum of Divisors</div>
							<div class="info-value">${divisors.reduce((a, b) => a + b, 0).toLocaleString()}</div>
						</div>
						<div class="info-item">
							<div class="info-label">Smallest Prime</div>
							<div class="info-value">${Math.min(...uniquePrimes)}</div>
						</div>
					</div>
				</div>`;

			resultsPanel.style.display = 'block';
		}

		// Generate first 50 primes
		function generatePrimes() {
			const primes = [];
			let n = 2;
			while (primes.length < 50) {
				if (isPrime(n)) primes.push(n);
				n++;
			}
			document.getElementById('primesList').innerHTML = primes.map(p =>
				`<span class="prime-num">${p}</span>`
			).join('');
		}

		// Initial
		generatePrimes();
		factorise();
	</script>
	<script src="/assets/shared-nav.js"></script>
</body>
</html>
