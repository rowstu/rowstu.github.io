<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Hash Generator // rowstu.net</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #1a1d23;
			--surface: #252932;
			--surface-hover: #2d323d;
			--border: #3d4351;
			--text: #e4e7eb;
			--text-muted: #9ca3af;
			--accent: #10b981;
			--accent-hover: #059669;
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }

		body {
			font-family: 'IBM Plex Mono', monospace;
			background: var(--bg);
			color: var(--text);
			min-height: 100vh;
			padding: 1.5rem;
		}

		.container { max-width: 800px; margin: 0 auto; }

		header { margin-bottom: 1.5rem; }

		h1 {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.subtitle { color: var(--text-muted); font-size: 0.875rem; }

		.panel {
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 8px;
			padding: 1.25rem;
			margin-bottom: 1rem;
		}

		.panel-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.panel-title {
			font-size: 0.875rem;
			font-weight: 500;
			color: var(--text-muted);
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}

		textarea {
			width: 100%;
			min-height: 150px;
			background: var(--bg);
			border: 1px solid var(--border);
			border-radius: 6px;
			padding: 1rem;
			color: var(--text);
			font-family: inherit;
			font-size: 0.9rem;
			resize: vertical;
			outline: none;
		}

		textarea:focus { border-color: var(--accent); }
		textarea::placeholder { color: var(--text-muted); }

		.hash-results {
			display: flex;
			flex-direction: column;
			gap: 0.75rem;
		}

		.hash-row {
			display: grid;
			grid-template-columns: 100px 1fr auto;
			gap: 1rem;
			align-items: center;
			padding: 0.75rem 1rem;
			background: var(--bg);
			border-radius: 6px;
		}

		.hash-label {
			font-weight: 500;
			color: var(--accent);
			font-size: 0.875rem;
		}

		.hash-value {
			font-size: 0.8rem;
			word-break: break-all;
			color: var(--text);
			font-family: inherit;
		}

		.hash-value.empty {
			color: var(--text-muted);
			font-style: italic;
		}

		.btn {
			background: var(--surface-hover);
			border: 1px solid var(--border);
			color: var(--text);
			padding: 0.5rem 0.75rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.75rem;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.btn:hover {
			background: var(--accent);
			border-color: var(--accent);
			color: #fff;
		}

		.btn.copied {
			background: var(--accent);
			border-color: var(--accent);
			color: #fff;
		}

		.options {
			display: flex;
			gap: 1.5rem;
			margin-bottom: 1rem;
			flex-wrap: wrap;
		}

		.option {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			cursor: pointer;
			font-size: 0.875rem;
		}

		.option input[type="checkbox"] {
			accent-color: var(--accent);
			width: 16px;
			height: 16px;
			cursor: pointer;
		}

		.file-drop {
			border: 2px dashed var(--border);
			border-radius: 8px;
			padding: 2rem;
			text-align: center;
			color: var(--text-muted);
			margin-bottom: 1rem;
			transition: all 0.15s ease;
		}

		.file-drop.drag-over {
			border-color: var(--accent);
			background: rgba(16, 185, 129, 0.1);
			color: var(--accent);
		}

		.file-drop input {
			display: none;
		}

		.file-drop-text {
			font-size: 0.875rem;
		}

		.file-drop-link {
			color: var(--accent);
			cursor: pointer;
			text-decoration: underline;
		}

		.file-info {
			margin-top: 0.5rem;
			font-size: 0.75rem;
			color: var(--accent);
		}

		.tabs {
			display: flex;
			gap: 0.5rem;
			margin-bottom: 1rem;
		}

		.tab {
			background: transparent;
			border: 1px solid var(--border);
			color: var(--text-muted);
			padding: 0.5rem 1rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.875rem;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.tab:hover {
			border-color: var(--accent);
			color: var(--text);
		}

		.tab.active {
			background: var(--accent);
			border-color: var(--accent);
			color: #fff;
		}

		.tab-content { display: none; }
		.tab-content.active { display: block; }

		@media (max-width: 600px) {
			.hash-row {
				grid-template-columns: 1fr;
				gap: 0.5rem;
			}

			.hash-row .btn {
				justify-self: start;
			}
		}
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>Hash Generator</h1>
			<p class="subtitle">Generate MD5, SHA-1, SHA-256, and SHA-512 hashes</p>
		</header>

		<div class="tabs">
			<button class="tab active" data-tab="text">Text Input</button>
			<button class="tab" data-tab="file">File Input</button>
		</div>

		<div id="text-tab" class="tab-content active">
			<div class="panel">
				<div class="panel-header">
					<span class="panel-title">Input Text</span>
				</div>
				<textarea id="textInput" placeholder="Enter text to hash..."></textarea>
			</div>
		</div>

		<div id="file-tab" class="tab-content">
			<div class="panel">
				<div class="file-drop" id="fileDrop">
					<input type="file" id="fileInput">
					<p class="file-drop-text">
						Drop a file here or <span class="file-drop-link" onclick="document.getElementById('fileInput').click()">browse</span>
					</p>
					<p class="file-info" id="fileInfo"></p>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">Options</span>
			</div>
			<div class="options">
				<label class="option">
					<input type="checkbox" id="uppercase">
					<span>Uppercase output</span>
				</label>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">Hash Results</span>
			</div>
			<div class="hash-results">
				<div class="hash-row">
					<span class="hash-label">MD5</span>
					<span class="hash-value empty" id="md5">Enter text or select a file</span>
					<button class="btn" onclick="copyHash('md5')">Copy</button>
				</div>
				<div class="hash-row">
					<span class="hash-label">SHA-1</span>
					<span class="hash-value empty" id="sha1">Enter text or select a file</span>
					<button class="btn" onclick="copyHash('sha1')">Copy</button>
				</div>
				<div class="hash-row">
					<span class="hash-label">SHA-256</span>
					<span class="hash-value empty" id="sha256">Enter text or select a file</span>
					<button class="btn" onclick="copyHash('sha256')">Copy</button>
				</div>
				<div class="hash-row">
					<span class="hash-label">SHA-512</span>
					<span class="hash-value empty" id="sha512">Enter text or select a file</span>
					<button class="btn" onclick="copyHash('sha512')">Copy</button>
				</div>
			</div>
		</div>
	</div>

	<script>
		// MD5 implementation (public domain)
		const md5 = (function() {
			function safeAdd(x, y) {
				const lsw = (x & 0xffff) + (y & 0xffff);
				const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
				return (msw << 16) | (lsw & 0xffff);
			}
			function bitRotateLeft(num, cnt) {
				return (num << cnt) | (num >>> (32 - cnt));
			}
			function md5cmn(q, a, b, x, s, t) {
				return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);
			}
			function md5ff(a, b, c, d, x, s, t) { return md5cmn((b & c) | (~b & d), a, b, x, s, t); }
			function md5gg(a, b, c, d, x, s, t) { return md5cmn((b & d) | (c & ~d), a, b, x, s, t); }
			function md5hh(a, b, c, d, x, s, t) { return md5cmn(b ^ c ^ d, a, b, x, s, t); }
			function md5ii(a, b, c, d, x, s, t) { return md5cmn(c ^ (b | ~d), a, b, x, s, t); }

			function binlMD5(x, len) {
				x[len >> 5] |= 0x80 << (len % 32);
				x[((len + 64) >>> 9 << 4) + 14] = len;
				let a = 1732584193, b = -271733879, c = -1732584194, d = 271733878;
				for (let i = 0; i < x.length; i += 16) {
					const olda = a, oldb = b, oldc = c, oldd = d;
					a = md5ff(a, b, c, d, x[i], 7, -680876936);
					d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);
					c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);
					b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);
					a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);
					d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);
					c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);
					b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);
					a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);
					d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);
					c = md5ff(c, d, a, b, x[i + 10], 17, -42063);
					b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);
					a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);
					d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);
					c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);
					b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);
					a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);
					d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);
					c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);
					b = md5gg(b, c, d, a, x[i], 20, -373897302);
					a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);
					d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);
					c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);
					b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);
					a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);
					d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);
					c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);
					b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);
					a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);
					d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);
					c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);
					b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);
					a = md5hh(a, b, c, d, x[i + 5], 4, -378558);
					d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);
					c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);
					b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);
					a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);
					d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);
					c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);
					b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);
					a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);
					d = md5hh(d, a, b, c, x[i], 11, -358537222);
					c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);
					b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);
					a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);
					d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);
					c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);
					b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);
					a = md5ii(a, b, c, d, x[i], 6, -198630844);
					d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);
					c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);
					b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);
					a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);
					d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);
					c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);
					b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);
					a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);
					d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);
					c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);
					b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);
					a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);
					d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);
					c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);
					b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);
					a = safeAdd(a, olda);
					b = safeAdd(b, oldb);
					c = safeAdd(c, oldc);
					d = safeAdd(d, oldd);
				}
				return [a, b, c, d];
			}

			function binl2hex(binarray) {
				const hexTab = '0123456789abcdef';
				let str = '';
				for (let i = 0; i < binarray.length * 4; i++) {
					str += hexTab.charAt((binarray[i >> 2] >> ((i % 4) * 8 + 4)) & 0xf) +
						   hexTab.charAt((binarray[i >> 2] >> ((i % 4) * 8)) & 0xf);
				}
				return str;
			}

			function str2binl(str) {
				const bin = [];
				for (let i = 0; i < str.length * 8; i += 8) {
					bin[i >> 5] |= (str.charCodeAt(i / 8) & 0xff) << (i % 32);
				}
				return bin;
			}

			function rawMD5(s) {
				return binlMD5(str2binl(s), s.length * 8);
			}

			return function(str) {
				const encoder = new TextEncoder();
				const data = encoder.encode(str);
				let s = '';
				for (let i = 0; i < data.length; i++) {
					s += String.fromCharCode(data[i]);
				}
				return binl2hex(rawMD5(s));
			};
		})();

		// For file hashing with MD5
		function md5ArrayBuffer(buffer) {
			const uint8Array = new Uint8Array(buffer);
			let s = '';
			for (let i = 0; i < uint8Array.length; i++) {
				s += String.fromCharCode(uint8Array[i]);
			}
			return md5(s);
		}

		// SHA hashing using Web Crypto API
		async function sha(algorithm, data) {
			const hashBuffer = await crypto.subtle.digest(algorithm, data);
			const hashArray = Array.from(new Uint8Array(hashBuffer));
			return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
		}

		// Elements
		const textInput = document.getElementById('textInput');
		const fileInput = document.getElementById('fileInput');
		const fileDrop = document.getElementById('fileDrop');
		const fileInfo = document.getElementById('fileInfo');
		const uppercaseCheckbox = document.getElementById('uppercase');
		const hashElements = {
			md5: document.getElementById('md5'),
			sha1: document.getElementById('sha1'),
			sha256: document.getElementById('sha256'),
			sha512: document.getElementById('sha512')
		};

		let currentMode = 'text';
		let currentFileData = null;

		// Tab switching
		document.querySelectorAll('.tab').forEach(tab => {
			tab.addEventListener('click', () => {
				document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
				document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
				tab.classList.add('active');
				document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
				currentMode = tab.dataset.tab;
				if (currentMode === 'text') {
					generateHashes();
				} else if (currentFileData) {
					generateFileHashes(currentFileData);
				} else {
					clearHashes();
				}
			});
		});

		// Text input
		textInput.addEventListener('input', generateHashes);

		// File input
		fileInput.addEventListener('change', handleFile);

		// Drag and drop
		fileDrop.addEventListener('dragover', e => {
			e.preventDefault();
			fileDrop.classList.add('drag-over');
		});

		fileDrop.addEventListener('dragleave', () => {
			fileDrop.classList.remove('drag-over');
		});

		fileDrop.addEventListener('drop', e => {
			e.preventDefault();
			fileDrop.classList.remove('drag-over');
			if (e.dataTransfer.files.length) {
				fileInput.files = e.dataTransfer.files;
				handleFile();
			}
		});

		// Uppercase option
		uppercaseCheckbox.addEventListener('change', () => {
			if (currentMode === 'text') {
				generateHashes();
			} else if (currentFileData) {
				generateFileHashes(currentFileData);
			}
		});

		function clearHashes() {
			Object.values(hashElements).forEach(el => {
				el.textContent = 'Enter text or select a file';
				el.classList.add('empty');
			});
		}

		async function generateHashes() {
			const text = textInput.value;
			if (!text) {
				clearHashes();
				return;
			}

			const encoder = new TextEncoder();
			const data = encoder.encode(text);
			const uppercase = uppercaseCheckbox.checked;

			// MD5
			let md5Hash = md5(text);
			if (uppercase) md5Hash = md5Hash.toUpperCase();
			hashElements.md5.textContent = md5Hash;
			hashElements.md5.classList.remove('empty');

			// SHA-1
			let sha1Hash = await sha('SHA-1', data);
			if (uppercase) sha1Hash = sha1Hash.toUpperCase();
			hashElements.sha1.textContent = sha1Hash;
			hashElements.sha1.classList.remove('empty');

			// SHA-256
			let sha256Hash = await sha('SHA-256', data);
			if (uppercase) sha256Hash = sha256Hash.toUpperCase();
			hashElements.sha256.textContent = sha256Hash;
			hashElements.sha256.classList.remove('empty');

			// SHA-512
			let sha512Hash = await sha('SHA-512', data);
			if (uppercase) sha512Hash = sha512Hash.toUpperCase();
			hashElements.sha512.textContent = sha512Hash;
			hashElements.sha512.classList.remove('empty');
		}

		function handleFile() {
			const file = fileInput.files[0];
			if (!file) return;

			fileInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;

			const reader = new FileReader();
			reader.onload = e => {
				currentFileData = e.target.result;
				generateFileHashes(currentFileData);
			};
			reader.readAsArrayBuffer(file);
		}

		async function generateFileHashes(buffer) {
			const uppercase = uppercaseCheckbox.checked;

			// MD5
			let md5Hash = md5ArrayBuffer(buffer);
			if (uppercase) md5Hash = md5Hash.toUpperCase();
			hashElements.md5.textContent = md5Hash;
			hashElements.md5.classList.remove('empty');

			// SHA-1
			let sha1Hash = await sha('SHA-1', buffer);
			if (uppercase) sha1Hash = sha1Hash.toUpperCase();
			hashElements.sha1.textContent = sha1Hash;
			hashElements.sha1.classList.remove('empty');

			// SHA-256
			let sha256Hash = await sha('SHA-256', buffer);
			if (uppercase) sha256Hash = sha256Hash.toUpperCase();
			hashElements.sha256.textContent = sha256Hash;
			hashElements.sha256.classList.remove('empty');

			// SHA-512
			let sha512Hash = await sha('SHA-512', buffer);
			if (uppercase) sha512Hash = sha512Hash.toUpperCase();
			hashElements.sha512.textContent = sha512Hash;
			hashElements.sha512.classList.remove('empty');
		}

		function formatFileSize(bytes) {
			if (bytes < 1024) return bytes + ' B';
			if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
			if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
			return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
		}

		function copyHash(type) {
			const el = hashElements[type];
			if (el.classList.contains('empty')) return;

			navigator.clipboard.writeText(el.textContent).then(() => {
				const btn = el.parentElement.querySelector('.btn');
				btn.textContent = 'Copied!';
				btn.classList.add('copied');
				setTimeout(() => {
					btn.textContent = 'Copy';
					btn.classList.remove('copied');
				}, 1500);
			});
		}
	</script>
	<script src="/assets/shared-nav.js"></script>
</body>
</html>
