<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Clone (Mobile) // rowstu.net</title>
    <style>
        body { 
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center; 
            min-height: calc(100vh - 60px); padding-top: 60px; 
            margin: 0; 
            background: #0d1117;
            touch-action: manipulation;
            overflow: hidden;
        }
        canvas { 
            border: 1px solid #000;
            max-width: 100%;
            height: auto;
        }
        #virtual-keyboard {
            display: none;
            max-width: 500px;
            width: 100%;
            margin-top: 20px;
            padding: 10px;
            background: #0d1117;
            position: fixed;
            bottom: 0;
            user-select: none;
        }
        .keyboard-row {
            display: flex;
            justify-content: center;
            margin: 5px 0;
        }
        .key {
            background-color: #d3d6da;
            border: none;
            border-radius: 4px;
            margin: 0 2px;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            min-width: 20px;
            text-align: center;
        }
        .key.wide {
            min-width: 65px;
        }
        @media (max-width: 600px) {
            canvas {
                margin-bottom: 200px;
            }
            .key {
                padding: 10px;
                font-size: 14px;
                min-width: 15px;
            }
            .key.wide {
                min-width: 45px;
            }
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="500" height="700"></canvas>
    <div id="virtual-keyboard">
        <div class="keyboard-row" id="row1"></div>
        <div class="keyboard-row" id="row2"></div>
        <div class="keyboard-row" id="row3">
            <button class="key wide" data-key="Enter">ENTER</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Constants
        const WIDTH = 500, HEIGHT = 700;
        const GRID_SIZE = 5;
        const GRID_SPACING = 10;
        const CELL_SIZE = 60;
        const MARGIN_TOP = 100;
        const KEYBOARD_MARGIN_TOP = 20;
        const KEYBOARD_MARGIN_BOTTOM = 20;
        const PROMPT_MARGIN_TOP = 10;

        // Colors
        const WHITE = '#FFFFFF';
        const BLACK = '#000000';
        const GRAY = '#808080';
        const GREEN = '#6AAA64';
        const YELLOW = '#C9B458';
        const LIGHT_GRAY = '#D3D6DA';

        // Game state
        let word = '';
        let guesses = [];
        let currentGuess = '';
        let gameOver = false;
        let message = '';
        let gameStarted = false;
        let showEndPrompt = false;

        const keyboard = [
            'QWERTYUIOP',
            'ASDFGHJKL',
            'ZXCVBNM'
        ];

        let keyStatus = {};
        keyboard.forEach(row => row.split('').forEach(key => keyStatus[key] = LIGHT_GRAY));

        // Two separate word lists
        const validGuesses = [
            // INSERT YOUR COMPREHENSIVE WORD LIST HERE (all valid 5-letter words)
        ];

        const targetWords = [
            "about", "above", "abuse", "actor", "acute", "admit", "adopt", "adult", "after", "again",
            "agent", "agree", "ahead", "alarm", "album", "alert", "alive", "allow", "alone", "along",
            "anger", "angle", "angry", "apple", "arena", "argue", "arise", "audio", "avoid", "award",
            "aware", "beach", "begin", "being", "below", "bench", "birth", "black", "blame", "blind",
            "block", "blood", "board", "brain", "brand", "bread", "break", "brief", "bring", "broad",
            "brown", "build", "burst", "cable", "carry", "catch", "cause", "chain", "chair", "chart",
            "chase", "cheap", "check", "chest", "chief", "child", "china", "claim", "class", "clean",
            "clear", "clock", "close", "coach", "coast", "count", "court", "cover", "craft", "crash",
            "cream", "crime", "cross", "crowd", "crown", "curve", "cycle", "daily", "dance", "death",
            "depth", "doubt", "draft", "drama", "dream", "dress", "drink", "drive", "early", "earth",
            "eight", "empty", "enemy", "enjoy", "enter", "equal", "error", "event", "exact", "exist",
            "extra", "faith", "false", "fault", "field", "fight", "final", "first", "fixed", "flash",
            "fleet", "floor", "focus", "force", "forth", "forty", "forum", "found", "frame", "frank",
            "fresh", "front", "fruit", "fully", "funny", "giant", "given", "glass", "globe", "going",
            "grace", "grade", "grand", "grant", "grass", "great", "green", "gross", "group", "guard",
            "guess", "guest", "guide", "happy", "heart", "heavy", "hello", "horse", "hotel", "house",
            "human", "ideal", "image", "index", "inner", "input", "issue", "japan", "joint", "judge",
            "knife", "known", "label", "large", "laser", "later", "laugh", "layer", "learn", "lease",
            "least", "leave", "legal", "level", "light", "limit", "local", "logic", "loose", "lower",
            "lucky", "lunch", "magic", "major", "march", "match", "maybe", "media", "metal", "might",
            "minor", "model", "money", "month", "moral", "motor", "mount", "mouse", "mouth", "movie",
            "music", "needs", "never", "night", "noise", "north", "novel", "nurse", "occur", "ocean",
            "offer", "often", "order", "other", "ought", "paint", "panel", "paper", "party", "peace",
            "phase", "phone", "photo", "piece", "pilot", "pitch", "place", "plain", "plane", "plant",
            "plate", "point", "pound", "power", "press", "price", "pride", "prime", "print", "prior",
            "prize", "proof", "proud", "prove", "queen", "quick", "quiet", "quite", "radio", "raise",
            "range", "rapid", "ratio", "reach", "ready", "refer", "right", "rival", "river", "robot",
            "round", "route", "royal", "rural", "scale", "scene", "scope", "score", "sense", "serve",
            "seven", "shall", "shape", "share", "sharp", "sheet", "shelf", "shell", "shift", "shirt",
            "shock", "shoot", "short", "shown", "sight", "since", "skill", "sleep", "slide", "small",
            "smart", "smile", "smoke", "solid", "solve", "sorry", "sound", "south", "space", "spare",
            "speak", "speed", "spend", "spent", "split", "spoke", "sport", "staff", "stage", "start",
            "state", "steam", "steel", "stick", "still", "stock", "stone", "store", "storm", "story",
            "strip", "stuck", "study", "style", "sugar", "sweet", "table", "taken", "taste", "teach",
            "teams", "teeth", "thank", "theme", "there", "thick", "thing", "think", "third", "those",
            "three", "throw", "tight", "times", "tired", "title", "today", "topic", "total", "touch",
            "tough", "tower", "track", "trade", "train", "treat", "trend", "trial", "tried", "tries",
            "truck", "truly", "trust", "truth", "twice", "under", "union", "unity", "until", "upper",
            "upset", "urban", "usage", "usual", "valid", "value", "video", "virus", "visit", "vital",
            "voice", "waste", "watch", "water", "where", "which", "while", "white", "whole", "whose",
            "woman", "world", "worry", "worse", "worst", "worth", "would", "wound", "write", "wrong"
        ];

        // Create sets for efficient lookup
        let validGuessSet = new Set([...validGuesses, ...targetWords]); // Include target words in valid guesses
        let wordSet = new Set(targetWords);

        function readRandomWord() {
            word = targetWords[Math.floor(Math.random() * targetWords.length)];
        }

        function createVirtualKeyboard() {
            const keyboard = document.getElementById('virtual-keyboard');
            const row1 = document.getElementById('row1');
            const row2 = document.getElementById('row2');
            const row3 = document.getElementById('row3');

            'QWERTYUIOP'.split('').forEach(letter => {
                const button = document.createElement('button');
                button.className = 'key';
                button.textContent = letter;
                button.dataset.key = letter;
                row1.appendChild(button);
            });

            'ASDFGHJKL'.split('').forEach(letter => {
                const button = document.createElement('button');
                button.className = 'key';
                button.textContent = letter;
                button.dataset.key = letter;
                row2.appendChild(button);
            });

            'ZXCVBNM'.split('').forEach(letter => {
                const button = document.createElement('button');
                button.className = 'key';
                button.textContent = letter;
                button.dataset.key = letter;
                row3.appendChild(button);
            });

            const backspace = document.createElement('button');
            backspace.className = 'key wide';
            backspace.textContent = 'âŒ«';
            backspace.dataset.key = 'Backspace';
            row3.appendChild(backspace);

            // Show virtual keyboard on mobile devices
            if ('ontouchstart' in window) {
                keyboard.style.display = 'block';
            }
        }

        function calculateColors(guess) {
            const colors = Array(5).fill(LIGHT_GRAY);
            const wordLetterCounts = {};

            // First pass: Mark correct letters
            for (let i = 0; i < 5; i++) {
                if (guess[i] === word[i]) {
                    colors[i] = GREEN;
                    wordLetterCounts[guess[i]] = (wordLetterCounts[guess[i]] || 0) + 1;
                }
            }

            // Second pass: Mark misplaced letters
            for (let i = 0; i < 5; i++) {
                if (colors[i] === LIGHT_GRAY) {
                    if (word.includes(guess[i])) {
                        const remainingCount = word.split(guess[i]).length - 1 - (wordLetterCounts[guess[i]] || 0);
                        if (remainingCount > 0) {
                            colors[i] = YELLOW;
                            wordLetterCounts[guess[i]] = (wordLetterCounts[guess[i]] || 0) + 1;
                        } else {
                            colors[i] = GRAY;
                        }
                    } else {
                        colors[i] = GRAY;
                    }
                }
            }
            return colors;
        }

        function drawGrid() {
            for (let row = 0; row < 6; row++) {
                for (let col = 0; col < GRID_SIZE; col++) {
                    const x = col * (CELL_SIZE + GRID_SPACING) + (WIDTH - (GRID_SIZE * (CELL_SIZE + GRID_SPACING) - GRID_SPACING)) / 2;
                    const y = row * (CELL_SIZE + GRID_SPACING) + MARGIN_TOP;

                    ctx.strokeStyle = BLACK;
                    ctx.lineWidth = 2;
                    ctx.strokeRect(x, y, CELL_SIZE, CELL_SIZE);

                    if (row < guesses.length) {
                        const colors = calculateColors(guesses[row]);
                        ctx.fillStyle = colors[col];
                        ctx.fillRect(x, y, CELL_SIZE, CELL_SIZE);
                        ctx.fillStyle = WHITE;
                        ctx.font = '36px Arial';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(guesses[row][col].toUpperCase(), x + CELL_SIZE / 2, y + CELL_SIZE / 2);
                    } else if (row === guesses.length && col < currentGuess.length) {
                        ctx.fillStyle = BLACK;
                        ctx.font = '36px Arial';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(currentGuess[col].toUpperCase(), x + CELL_SIZE / 2, y + CELL_SIZE / 2);
                    }
                }
            }
        }

        function drawKeyboard() {
            // Only draw the keyboard if we're not on a touch device
            if (!('ontouchstart' in window)) {
                let y = HEIGHT - KEYBOARD_MARGIN_BOTTOM - (3 * (40 + 5));
                keyboard.forEach(row => {
                    let x = (WIDTH - row.length * 35) / 2;
                    row.split('').forEach(key => {
                        ctx.fillStyle = keyStatus[key];
                        ctx.fillRect(x, y, 30, 40);
                        ctx.fillStyle = (keyStatus[key] === LIGHT_GRAY) ? BLACK : WHITE;
                        ctx.font = '20px Arial';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(key, x + 15, y + 20);
                        x += 35;
                    });
                    y += 45;
                });
            }
        }

        function drawMessage() {
            ctx.fillStyle = BLACK;
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';

            // Split long messages into multiple lines
            const maxWidth = WIDTH - 40; // Leave some margin
            let words = message.split(' ');
            let lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                let testLine = currentLine + ' ' + words[i];
                let metrics = ctx.measureText(testLine);
                if (metrics.width > maxWidth) {
                    lines.push(currentLine);
                    currentLine = words[i];
                } else {
                    currentLine = testLine;
                }
            }
            lines.push(currentLine);

            // Draw each line
            lines.forEach((line, index) => {
                ctx.fillText(line, WIDTH / 2, 20 + (index * 25));
            });
        }

        function drawStartScreen() {
            ctx.fillStyle = BLACK;
            ctx.font = '48px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('Wordle', WIDTH / 2, HEIGHT / 4);

            const instructions = [
                'Guess the 5-letter word in 6 tries.',
                'Green: Correct letter, correct spot',
                'Yellow: Correct letter, wrong spot',
                'Gray: Letter not in the word',
                '',
                'Press any key to start'
            ];

            ctx.font = '18px Arial';
            instructions.forEach((line, index) => {
                ctx.fillText(line, WIDTH / 2, HEIGHT / 2 + index * 30);
            });
        }

        function drawEndGamePrompt() {
            ctx.fillStyle = BLACK;
            ctx.font = '18px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // Adjust position based on device type
            const promptY = ('ontouchstart' in window) 
                ? HEIGHT - 50  // Higher position on mobile
                : HEIGHT - KEYBOARD_MARGIN_BOTTOM - (3 * (40 + 5)) - PROMPT_MARGIN_TOP;
            
            ctx.fillText('Press ENTER to play again or ESC to quit', WIDTH / 2, promptY);
        }

        function updateKeyStatus(guess) {
            const colors = calculateColors(guess);
            for (let i = 0; i < guess.length; i++) {
                const letter = guess[i].toUpperCase();
                const color = colors[i];
                keyStatus[letter] = color;

                // Update virtual keyboard colors
                const virtualKey = document.querySelector(`[data-key="${letter}"]`);
                if (virtualKey) {
                    virtualKey.style.backgroundColor = color;
                    if (color === GREEN || color === YELLOW || color === GRAY) {
                        virtualKey.style.color = '#ffffff';
                    }
                }
            }
        }

        function checkGuess(guess) {
            if (guess === word) {
                gameOver = true;
                message = `Correct! The word was '${word}'`;
            } else if (guesses.length === 6) {
                gameOver = true;
                message = `Game over. Word: '${word}'`;
            }
        }

        function handleVirtualKeyPress(key) {
            const event = {
                key: key,
                code: key === 'Enter' ? 'Enter' : 
                      key === 'Backspace' ? 'Backspace' : 
                      `Key${key}`,
            };
            handleKeyDown(event);
        }

        function handleKeyDown(event) {
            if (!gameStarted) {
                gameStarted = true;
                readRandomWord();
                guesses = [];
                currentGuess = '';
                gameOver = false;
                message = '';
                showEndPrompt = false;
                keyboard.forEach(row => row.split('').forEach(key => keyStatus[key] = LIGHT_GRAY));
                
                // Reset virtual keyboard colors
                document.querySelectorAll('.key').forEach(key => {
                    key.style.backgroundColor = LIGHT_GRAY;
                    key.style.color = BLACK;
                });
            } else if (!gameOver) {
                if (event.code === 'Enter' && currentGuess.length === 5) {
                    if (validGuessSet.has(currentGuess.toLowerCase())) { // Check against validGuessSet instead
                        guesses.push(currentGuess);
                        updateKeyStatus(currentGuess);
                        checkGuess(currentGuess);
                        currentGuess = '';
                        if (gameOver) {
                            showEndPrompt = true;
                        }
                    } else {
                        message = 'Not in word list';
                    }
                } else if (event.code === 'Backspace') {
                    currentGuess = currentGuess.slice(0, -1);
                    message = '';
                } else if (currentGuess.length < 5 && event.key.match(/^[a-zA-Z]$/)) {
                    currentGuess += event.key.toLowerCase();
                    message = '';
                }
            } else if (showEndPrompt) {
                if (event.code === 'Enter') {
                    gameStarted = false;
                    showEndPrompt = false;
                } else if (event.code === 'Escape') {
                    gameStarted = false;
                    showEndPrompt = false;
                }
            }
        }

        function gameLoop() {
            ctx.fillStyle = WHITE;
            ctx.fillRect(0, 0, WIDTH, HEIGHT);

            if (!gameStarted) {
                drawStartScreen();
            } else {
                if (message) {
                    drawMessage();
                }
                drawGrid();
                if (showEndPrompt) {
                    drawEndGamePrompt();
                }
                drawKeyboard();
            }

            requestAnimationFrame(gameLoop);
        }

        // Initialize game
        document.addEventListener('DOMContentLoaded', () => {
            createVirtualKeyboard();
            
            // Add touch event listeners for virtual keyboard
            document.getElementById('virtual-keyboard').addEventListener('click', (e) => {
                const key = e.target.dataset.key;
                if (key) {
                    handleVirtualKeyPress(key);
                }
            });

            document.addEventListener('keydown', handleKeyDown);
            gameLoop();
        });
    </script>
    <script src="/assets/shared-nav.js"></script>
</body>
</html>
