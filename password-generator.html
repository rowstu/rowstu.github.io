<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Password Generator // rowstu.net</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #1a1d23;
			--surface: #252932;
			--surface-hover: #2d323d;
			--border: #3d4351;
			--text: #e4e7eb;
			--text-muted: #9ca3af;
			--accent: #10b981;
			--accent-hover: #059669;
			--warning: #f59e0b;
			--danger: #ef4444;
			--info: #3b82f6;
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }

		body {
			font-family: 'IBM Plex Mono', monospace;
			background: var(--bg);
			color: var(--text);
			min-height: 100vh;
			padding: 1.5rem;
		}

		.container { max-width: 700px; margin: 0 auto; }

		header { margin-bottom: 1.5rem; }

		h1 {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.subtitle { color: var(--text-muted); font-size: 0.875rem; }

		.panel {
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 8px;
			padding: 1.25rem;
			margin-bottom: 1rem;
		}

		.panel-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.panel-title {
			font-size: 0.875rem;
			font-weight: 500;
			color: var(--text-muted);
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}

		.password-display {
			background: var(--bg);
			border-radius: 6px;
			padding: 1.25rem;
			margin-bottom: 1rem;
			position: relative;
		}

		.password-text {
			font-size: 1.4rem;
			word-break: break-all;
			line-height: 1.5;
			min-height: 2.5rem;
			letter-spacing: 0.05em;
		}

		.char-lower { color: var(--text); }
		.char-upper { color: var(--accent); }
		.char-number { color: var(--warning); }
		.char-symbol { color: #f472b6; }

		.password-actions {
			display: flex;
			gap: 0.5rem;
			margin-top: 1rem;
		}

		.btn {
			background: var(--accent);
			border: none;
			color: #fff;
			padding: 0.6rem 1.25rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.875rem;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.15s ease;
			flex: 1;
		}

		.btn:hover {
			background: var(--accent-hover);
		}

		.btn-secondary {
			background: var(--surface-hover);
			border: 1px solid var(--border);
			flex: none;
			padding: 0.6rem 1rem;
		}

		.btn-secondary:hover {
			border-color: var(--accent);
			color: var(--accent);
			background: var(--surface-hover);
		}

		.options-grid {
			display: grid;
			gap: 1rem;
		}

		.option-row {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 0.75rem;
			background: var(--bg);
			border-radius: 6px;
		}

		.option-label {
			display: flex;
			flex-direction: column;
			gap: 0.15rem;
		}

		.option-name {
			font-size: 0.9rem;
			color: var(--text);
		}

		.option-desc {
			font-size: 0.75rem;
			color: var(--text-muted);
		}

		.option-control {
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		input[type="checkbox"] {
			appearance: none;
			width: 20px;
			height: 20px;
			background: var(--surface);
			border: 2px solid var(--border);
			border-radius: 4px;
			cursor: pointer;
			position: relative;
		}

		input[type="checkbox"]:checked {
			background: var(--accent);
			border-color: var(--accent);
		}

		input[type="checkbox"]:checked::after {
			content: 'âœ“';
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			color: white;
			font-size: 12px;
			font-weight: bold;
		}

		input[type="range"] {
			width: 150px;
			height: 6px;
			background: var(--border);
			border-radius: 3px;
			appearance: none;
			cursor: pointer;
		}

		input[type="range"]::-webkit-slider-thumb {
			appearance: none;
			width: 18px;
			height: 18px;
			background: var(--accent);
			border-radius: 50%;
			cursor: pointer;
		}

		input[type="range"]::-moz-range-thumb {
			width: 18px;
			height: 18px;
			background: var(--accent);
			border-radius: 50%;
			cursor: pointer;
			border: none;
		}

		.length-value {
			min-width: 35px;
			text-align: center;
			font-weight: 600;
			color: var(--accent);
		}

		.strength-meter {
			margin-top: 1rem;
		}

		.strength-bar {
			height: 6px;
			background: var(--border);
			border-radius: 3px;
			overflow: hidden;
			margin-bottom: 0.5rem;
		}

		.strength-fill {
			height: 100%;
			border-radius: 3px;
			transition: all 0.3s ease;
		}

		.strength-fill.weak { width: 25%; background: var(--danger); }
		.strength-fill.fair { width: 50%; background: var(--warning); }
		.strength-fill.good { width: 75%; background: var(--info); }
		.strength-fill.strong { width: 100%; background: var(--accent); }

		.strength-info {
			display: flex;
			justify-content: space-between;
			font-size: 0.75rem;
		}

		.strength-label {
			text-transform: uppercase;
			font-weight: 600;
		}

		.strength-label.weak { color: var(--danger); }
		.strength-label.fair { color: var(--warning); }
		.strength-label.good { color: var(--info); }
		.strength-label.strong { color: var(--accent); }

		.strength-entropy {
			color: var(--text-muted);
		}

		.history-list {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
			max-height: 200px;
			overflow-y: auto;
		}

		.history-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 0.5rem 0.75rem;
			background: var(--bg);
			border-radius: 4px;
			font-size: 0.8rem;
		}

		.history-password {
			font-family: inherit;
			word-break: break-all;
			flex: 1;
			margin-right: 0.5rem;
		}

		.history-copy {
			background: transparent;
			border: 1px solid var(--border);
			color: var(--text-muted);
			padding: 0.25rem 0.5rem;
			border-radius: 3px;
			font-family: inherit;
			font-size: 0.7rem;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.history-copy:hover {
			border-color: var(--accent);
			color: var(--accent);
		}

		.empty {
			text-align: center;
			padding: 1rem;
			color: var(--text-muted);
			font-size: 0.85rem;
		}

		.copied-toast {
			position: fixed;
			bottom: 2rem;
			left: 50%;
			transform: translateX(-50%) translateY(100px);
			background: var(--accent);
			color: white;
			padding: 0.75rem 1.5rem;
			border-radius: 6px;
			font-size: 0.875rem;
			font-weight: 500;
			opacity: 0;
			transition: all 0.3s ease;
			pointer-events: none;
		}

		.copied-toast.show {
			opacity: 1;
			transform: translateX(-50%) translateY(0);
		}

		.presets {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
			margin-bottom: 1rem;
		}

		.preset {
			background: var(--surface-hover);
			border: 1px solid var(--border);
			color: var(--text);
			padding: 0.4rem 0.75rem;
			border-radius: 4px;
			font-family: inherit;
			font-size: 0.75rem;
			cursor: pointer;
			transition: all 0.15s ease;
		}

		.preset:hover {
			border-color: var(--accent);
			color: var(--accent);
		}

		.preset.active {
			background: var(--accent);
			border-color: var(--accent);
			color: white;
		}
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>Password Generator</h1>
			<p class="subtitle">Generate secure random passwords</p>
		</header>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">Generated Password</span>
			</div>
			<div class="password-display">
				<div class="password-text" id="passwordDisplay">Click Generate to create a password</div>
			</div>
			<div class="password-actions">
				<button class="btn" onclick="generate()">Generate</button>
				<button class="btn btn-secondary" onclick="copyPassword()">Copy</button>
			</div>
			<div class="strength-meter" id="strengthMeter" style="display: none;">
				<div class="strength-bar">
					<div class="strength-fill" id="strengthFill"></div>
				</div>
				<div class="strength-info">
					<span class="strength-label" id="strengthLabel">-</span>
					<span class="strength-entropy" id="strengthEntropy">-</span>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">Options</span>
			</div>
			<div class="presets">
				<button class="preset" onclick="applyPreset('pin')">PIN (4 digits)</button>
				<button class="preset" onclick="applyPreset('simple')">Simple (12 chars)</button>
				<button class="preset active" onclick="applyPreset('strong')">Strong (16 chars)</button>
				<button class="preset" onclick="applyPreset('paranoid')">Paranoid (32 chars)</button>
				<button class="preset" onclick="applyPreset('passphrase')">Passphrase</button>
			</div>
			<div class="options-grid">
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Length</span>
						<span class="option-desc">Number of characters</span>
					</div>
					<div class="option-control">
						<input type="range" id="length" min="4" max="64" value="16" oninput="updateLength()">
						<span class="length-value" id="lengthValue">16</span>
					</div>
				</div>
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Uppercase</span>
						<span class="option-desc">A-Z</span>
					</div>
					<div class="option-control">
						<input type="checkbox" id="uppercase" checked>
					</div>
				</div>
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Lowercase</span>
						<span class="option-desc">a-z</span>
					</div>
					<div class="option-control">
						<input type="checkbox" id="lowercase" checked>
					</div>
				</div>
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Numbers</span>
						<span class="option-desc">0-9</span>
					</div>
					<div class="option-control">
						<input type="checkbox" id="numbers" checked>
					</div>
				</div>
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Symbols</span>
						<span class="option-desc">!@#$%^&*()_+-=[]{}|;:,.<>?</span>
					</div>
					<div class="option-control">
						<input type="checkbox" id="symbols" checked>
					</div>
				</div>
				<div class="option-row">
					<div class="option-label">
						<span class="option-name">Exclude Ambiguous</span>
						<span class="option-desc">Avoid 0, O, l, 1, I</span>
					</div>
					<div class="option-control">
						<input type="checkbox" id="excludeAmbiguous">
					</div>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="panel-title">History</span>
				<button class="btn btn-secondary" style="padding: 0.3rem 0.6rem; font-size: 0.7rem;" onclick="clearHistory()">Clear</button>
			</div>
			<div class="history-list" id="historyList">
				<div class="empty">Generated passwords will appear here</div>
			</div>
		</div>
	</div>

	<div class="copied-toast" id="toast">Copied to clipboard!</div>

	<script>
		const charSets = {
			uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
			lowercase: 'abcdefghijklmnopqrstuvwxyz',
			numbers: '0123456789',
			symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
		};

		const ambiguous = '0O1lI';
		let history = [];
		let currentPassword = '';

		// Passphrase word list (common, easy to type words)
		const words = [
			'apple', 'baker', 'camel', 'delta', 'eagle', 'frost', 'grape', 'honey',
			'ivory', 'jolly', 'karma', 'lemon', 'mango', 'noble', 'ocean', 'piano',
			'queen', 'robot', 'solar', 'tiger', 'ultra', 'vivid', 'waltz', 'xenon',
			'yacht', 'zebra', 'amber', 'blaze', 'crisp', 'dream', 'ember', 'flame',
			'gleam', 'haste', 'ideal', 'jumbo', 'knack', 'lunar', 'maple', 'ninja',
			'oasis', 'prism', 'quest', 'realm', 'storm', 'tempo', 'unity', 'valor',
			'wired', 'xylon', 'youth', 'zesty', 'arrow', 'brave', 'cloud', 'dusk'
		];

		const presets = {
			pin: { length: 4, uppercase: false, lowercase: false, numbers: true, symbols: false, excludeAmbiguous: false },
			simple: { length: 12, uppercase: true, lowercase: true, numbers: true, symbols: false, excludeAmbiguous: false },
			strong: { length: 16, uppercase: true, lowercase: true, numbers: true, symbols: true, excludeAmbiguous: false },
			paranoid: { length: 32, uppercase: true, lowercase: true, numbers: true, symbols: true, excludeAmbiguous: true },
			passphrase: { length: 4, passphrase: true }
		};

		function updateLength() {
			document.getElementById('lengthValue').textContent = document.getElementById('length').value;
		}

		function applyPreset(name) {
			document.querySelectorAll('.preset').forEach(p => p.classList.remove('active'));
			event.target.classList.add('active');

			const preset = presets[name];
			if (preset.passphrase) {
				generatePassphrase();
				return;
			}

			document.getElementById('length').value = preset.length;
			document.getElementById('lengthValue').textContent = preset.length;
			document.getElementById('uppercase').checked = preset.uppercase;
			document.getElementById('lowercase').checked = preset.lowercase;
			document.getElementById('numbers').checked = preset.numbers;
			document.getElementById('symbols').checked = preset.symbols;
			document.getElementById('excludeAmbiguous').checked = preset.excludeAmbiguous;
			generate();
		}

		function generatePassphrase() {
			const numWords = 4;
			const selectedWords = [];
			const array = new Uint32Array(numWords);
			crypto.getRandomValues(array);

			for (let i = 0; i < numWords; i++) {
				selectedWords.push(words[array[i] % words.length]);
			}

			// Capitalize first letter of each word and join with hyphens
			currentPassword = selectedWords.map(w => w.charAt(0).toUpperCase() + w.slice(1)).join('-');
			displayPassword(currentPassword);
			addToHistory(currentPassword);
			updateStrength(currentPassword, true);
		}

		function generate() {
			const length = parseInt(document.getElementById('length').value);
			const useUppercase = document.getElementById('uppercase').checked;
			const useLowercase = document.getElementById('lowercase').checked;
			const useNumbers = document.getElementById('numbers').checked;
			const useSymbols = document.getElementById('symbols').checked;
			const excludeAmbig = document.getElementById('excludeAmbiguous').checked;

			let charset = '';
			if (useUppercase) charset += charSets.uppercase;
			if (useLowercase) charset += charSets.lowercase;
			if (useNumbers) charset += charSets.numbers;
			if (useSymbols) charset += charSets.symbols;

			if (excludeAmbig) {
				charset = charset.split('').filter(c => !ambiguous.includes(c)).join('');
			}

			if (charset.length === 0) {
				document.getElementById('passwordDisplay').textContent = 'Select at least one character type';
				document.getElementById('strengthMeter').style.display = 'none';
				return;
			}

			// Use crypto.getRandomValues for secure randomness
			const array = new Uint32Array(length);
			crypto.getRandomValues(array);

			let password = '';
			for (let i = 0; i < length; i++) {
				password += charset[array[i] % charset.length];
			}

			currentPassword = password;
			displayPassword(password);
			addToHistory(password);
			updateStrength(password, false);
		}

		function displayPassword(password) {
			const display = document.getElementById('passwordDisplay');
			display.innerHTML = password.split('').map(char => {
				let cls = 'char-lower';
				if (/[A-Z]/.test(char)) cls = 'char-upper';
				else if (/[0-9]/.test(char)) cls = 'char-number';
				else if (/[^a-zA-Z0-9]/.test(char)) cls = 'char-symbol';
				return `<span class="${cls}">${escapeHtml(char)}</span>`;
			}).join('');
		}

		function updateStrength(password, isPassphrase) {
			const meter = document.getElementById('strengthMeter');
			const fill = document.getElementById('strengthFill');
			const label = document.getElementById('strengthLabel');
			const entropy = document.getElementById('strengthEntropy');

			meter.style.display = 'block';

			let entropyBits;
			if (isPassphrase) {
				// Passphrase entropy: log2(wordlist_size^num_words)
				entropyBits = Math.floor(4 * Math.log2(words.length));
			} else {
				// Calculate charset size
				let charsetSize = 0;
				if (/[a-z]/.test(password)) charsetSize += 26;
				if (/[A-Z]/.test(password)) charsetSize += 26;
				if (/[0-9]/.test(password)) charsetSize += 10;
				if (/[^a-zA-Z0-9]/.test(password)) charsetSize += 32;
				entropyBits = Math.floor(password.length * Math.log2(charsetSize || 1));
			}

			let strength, strengthClass;
			if (entropyBits < 28) {
				strength = 'Weak';
				strengthClass = 'weak';
			} else if (entropyBits < 36) {
				strength = 'Fair';
				strengthClass = 'fair';
			} else if (entropyBits < 60) {
				strength = 'Good';
				strengthClass = 'good';
			} else {
				strength = 'Strong';
				strengthClass = 'strong';
			}

			fill.className = 'strength-fill ' + strengthClass;
			label.className = 'strength-label ' + strengthClass;
			label.textContent = strength;
			entropy.textContent = `~${entropyBits} bits of entropy`;
		}

		function copyPassword() {
			if (!currentPassword) return;
			navigator.clipboard.writeText(currentPassword).then(() => {
				showToast();
			});
		}

		function showToast() {
			const toast = document.getElementById('toast');
			toast.classList.add('show');
			setTimeout(() => toast.classList.remove('show'), 2000);
		}

		function addToHistory(password) {
			history.unshift(password);
			if (history.length > 10) history.pop();
			renderHistory();
		}

		function renderHistory() {
			const list = document.getElementById('historyList');
			if (history.length === 0) {
				list.innerHTML = '<div class="empty">Generated passwords will appear here</div>';
				return;
			}

			list.innerHTML = history.map((pw, i) => `
				<div class="history-item">
					<span class="history-password">${escapeHtml(pw)}</span>
					<button class="history-copy" onclick="copyFromHistory(${i})">Copy</button>
				</div>
			`).join('');
		}

		function copyFromHistory(index) {
			navigator.clipboard.writeText(history[index]).then(() => {
				showToast();
			});
		}

		function clearHistory() {
			history = [];
			renderHistory();
		}

		function escapeHtml(text) {
			const div = document.createElement('div');
			div.textContent = text;
			return div.innerHTML;
		}

		// Generate initial password
		generate();
	</script>
	<script src="/assets/shared-nav.js"></script>
</body>
</html>
