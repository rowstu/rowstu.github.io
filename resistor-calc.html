<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Resistor Colour Code Calculator</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #1a1d23;
			--surface: #252932;
			--surface-hover: #2d323d;
			--border: #3d4351;
			--text: #e4e7eb;
			--text-muted: #9ca3af;
			--accent: #f59e0b;
			--accent-alt: #10b981;

			/* Resistor band colours */
			--band-black: #1a1a1a;
			--band-brown: #8b4513;
			--band-red: #dc2626;
			--band-orange: #f97316;
			--band-yellow: #fbbf24;
			--band-green: #22c55e;
			--band-blue: #3b82f6;
			--band-violet: #8b5cf6;
			--band-grey: #6b7280;
			--band-white: #f5f5f5;
			--band-gold: #d4a017;
			--band-silver: #c0c0c0;
		}

		* { margin: 0; padding: 0; box-sizing: border-box; }

		body {
			font-family: 'IBM Plex Mono', monospace;
			background: var(--bg);
			color: var(--text);
			min-height: 100vh;
			padding: 1.5rem;
		}

		.container { max-width: 900px; margin: 0 auto; }

		header { margin-bottom: 1.5rem; }

		h1 {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.subtitle { color: var(--text-muted); font-size: 0.875rem; }

		.panel {
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 6px;
			margin-bottom: 1rem;
			overflow: hidden;
		}

		.panel-header {
			padding: 0.75rem 1rem;
			border-bottom: 1px solid var(--border);
			font-size: 0.8rem;
			color: var(--text-muted);
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.panel-header .label { font-weight: 500; color: var(--text); }

		.panel-content { padding: 1rem; }

		/* Band selector */
		.band-selector {
			display: flex;
			gap: 0.5rem;
			margin-bottom: 1.5rem;
			flex-wrap: wrap;
		}

		.band-btn {
			padding: 0.5rem 1rem;
			background: var(--surface-hover);
			border: 2px solid var(--border);
			border-radius: 4px;
			color: var(--text);
			font-family: inherit;
			font-size: 0.85rem;
			cursor: pointer;
			transition: all 0.2s;
		}

		.band-btn:hover {
			border-color: var(--accent);
		}

		.band-btn.active {
			background: var(--accent);
			border-color: var(--accent);
			color: #000;
		}

		/* Resistor visualisation */
		.resistor-container {
			display: flex;
			justify-content: center;
			align-items: center;
			padding: 2rem 1rem;
			background: var(--bg);
			border-radius: 6px;
			margin-bottom: 1.5rem;
		}

		.resistor {
			position: relative;
			display: flex;
			align-items: center;
		}

		.resistor-lead {
			width: 40px;
			height: 4px;
			background: linear-gradient(to bottom, #c0c0c0, #a0a0a0, #c0c0c0);
		}

		.resistor-body {
			position: relative;
			width: 200px;
			height: 60px;
			background: linear-gradient(to bottom, #d4c4a8, #c4b498, #a89878, #c4b498, #d4c4a8);
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 8px;
			padding: 0 20px;
			box-shadow: 0 4px 8px rgba(0,0,0,0.3);
		}

		.resistor-body::before,
		.resistor-body::after {
			content: '';
			position: absolute;
			width: 15px;
			height: 50px;
			background: linear-gradient(to bottom, #d4c4a8, #c4b498, #a89878);
			border-radius: 4px;
		}

		.resistor-body::before { left: -8px; }
		.resistor-body::after { right: -8px; }

		.band {
			width: 12px;
			height: 50px;
			border-radius: 2px;
			box-shadow: inset 0 0 3px rgba(0,0,0,0.3);
			cursor: pointer;
			transition: transform 0.2s;
			flex-shrink: 0;
		}

		.band:hover {
			transform: scaleY(1.05);
		}

		.band.tolerance {
			margin-left: 15px;
		}

		.band.temp-coef {
			margin-left: 8px;
		}

		/* Colour picker */
		.band-pickers {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
			gap: 1rem;
			margin-bottom: 1.5rem;
		}

		.picker-group {
			background: var(--surface-hover);
			border-radius: 6px;
			padding: 1rem;
			min-width: 0;
		}

		.picker-group.hidden {
			display: none;
		}

		.picker-label {
			font-size: 0.75rem;
			color: var(--text-muted);
			margin-bottom: 0.5rem;
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}

		.colour-options {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(28px, 28px));
			gap: 0.35rem;
		}

		.colour-btn {
			width: 28px;
			height: 28px;
			border: 2px solid var(--border);
			border-radius: 4px;
			cursor: pointer;
			transition: all 0.2s;
			position: relative;
			padding: 0;
			background: var(--surface);
		}

		.colour-btn:hover {
			transform: scale(1.1);
			z-index: 1;
		}

		.colour-btn.selected {
			border-color: var(--text);
			box-shadow: 0 0 0 2px var(--accent);
		}

		.colour-btn[data-colour="black"] { background: var(--band-black); }
		.colour-btn[data-colour="brown"] { background: var(--band-brown); }
		.colour-btn[data-colour="red"] { background: var(--band-red); }
		.colour-btn[data-colour="orange"] { background: var(--band-orange); }
		.colour-btn[data-colour="yellow"] { background: var(--band-yellow); }
		.colour-btn[data-colour="green"] { background: var(--band-green); }
		.colour-btn[data-colour="blue"] { background: var(--band-blue); }
		.colour-btn[data-colour="violet"] { background: var(--band-violet); }
		.colour-btn[data-colour="grey"] { background: var(--band-grey); }
		.colour-btn[data-colour="white"] { background: var(--band-white); }
		.colour-btn[data-colour="gold"] { background: linear-gradient(135deg, #d4a017, #f4c430, #d4a017); }
		.colour-btn[data-colour="silver"] { background: linear-gradient(135deg, #a0a0a0, #d0d0d0, #a0a0a0); }
		.colour-btn[data-colour="none"] {
			background: var(--surface);
			position: relative;
		}
		.colour-btn[data-colour="none"]::after {
			content: '∅';
			position: absolute;
			inset: 0;
			display: flex;
			align-items: center;
			justify-content: center;
			color: var(--text-muted);
			font-size: 0.8rem;
		}

		/* Results */
		.result-box {
			background: var(--bg);
			border-radius: 6px;
			padding: 1.5rem;
			text-align: center;
			margin-bottom: 1rem;
		}

		.result-value {
			font-size: 2.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.result-tolerance {
			font-size: 1rem;
			color: var(--accent-alt);
			margin-bottom: 0.25rem;
		}

		.result-range {
			font-size: 0.85rem;
			color: var(--text-muted);
		}

		.result-temp {
			font-size: 0.85rem;
			color: var(--text-muted);
			margin-top: 0.25rem;
		}

		/* Reference table */
		.reference-table {
			width: 100%;
			border-collapse: collapse;
			font-size: 0.8rem;
		}

		.reference-table th,
		.reference-table td {
			padding: 0.5rem;
			text-align: center;
			border-bottom: 1px solid var(--border);
		}

		.reference-table th {
			color: var(--text-muted);
			font-weight: 500;
			background: var(--surface-hover);
		}

		.reference-table td:first-child {
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		.colour-swatch {
			width: 20px;
			height: 14px;
			border-radius: 2px;
			border: 1px solid var(--border);
		}

		.back-link {
			display: inline-block;
			margin-top: 1rem;
			color: var(--text-muted);
			text-decoration: none;
			font-size: 0.875rem;
		}

		.back-link:hover { color: var(--accent); }

		/* Value input mode */
		.input-mode {
			margin-bottom: 1.5rem;
		}

		.input-row {
			display: flex;
			gap: 0.5rem;
			align-items: flex-end;
			flex-wrap: wrap;
		}

		.input-group {
			flex: 1;
			min-width: 150px;
		}

		.input-group label {
			display: block;
			margin-bottom: 0.5rem;
			font-size: 0.85rem;
			color: var(--text-muted);
		}

		input[type="text"],
		select {
			width: 100%;
			padding: 0.75rem 1rem;
			background: var(--surface-hover);
			border: 1px solid var(--border);
			border-radius: 4px;
			color: var(--text);
			font-family: inherit;
			font-size: 1rem;
			outline: none;
			transition: border-color 0.2s;
		}

		input[type="text"]:focus,
		select:focus {
			border-color: var(--accent);
		}

		.calc-btn {
			padding: 0.75rem 1.5rem;
			background: var(--accent);
			border: none;
			border-radius: 4px;
			color: #000;
			font-family: inherit;
			font-size: 0.9rem;
			font-weight: 500;
			cursor: pointer;
			transition: all 0.2s;
		}

		.calc-btn:hover {
			background: #e68a00;
		}

		@media (max-width: 600px) {
			.resistor-body {
				width: 160px;
				height: 50px;
			}
			.band {
				width: 10px;
				height: 40px;
			}
			.resistor-lead {
				width: 25px;
			}
			.result-value {
				font-size: 1.8rem;
			}
		}
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>Resistor Colour Code Calculator</h1>
			<p class="subtitle">Calculate resistance from colour bands or find bands from value</p>
		</header>

		<div class="panel">
			<div class="panel-header">
				<span class="label">Number of Bands</span>
			</div>
			<div class="panel-content">
				<div class="band-selector">
					<button class="band-btn" data-bands="3">3 Band</button>
					<button class="band-btn active" data-bands="4">4 Band</button>
					<button class="band-btn" data-bands="5">5 Band</button>
					<button class="band-btn" data-bands="6">6 Band</button>
				</div>

				<div class="resistor-container">
					<div class="resistor">
						<div class="resistor-lead"></div>
						<div class="resistor-body">
							<div class="band" id="band1" style="background: var(--band-brown);"></div>
							<div class="band" id="band2" style="background: var(--band-black);"></div>
							<div class="band" id="band3" style="background: var(--band-red);"></div>
							<div class="band" id="band4" style="background: var(--band-gold);"></div>
							<div class="band hidden" id="band5" style="background: var(--band-brown);"></div>
							<div class="band tolerance hidden" id="band6" style="background: var(--band-brown);"></div>
						</div>
						<div class="resistor-lead"></div>
					</div>
				</div>

				<div class="band-pickers">
					<div class="picker-group" id="picker1">
						<div class="picker-label">Band 1 (1st Digit)</div>
						<div class="colour-options" data-band="1"></div>
					</div>
					<div class="picker-group" id="picker2">
						<div class="picker-label">Band 2 (2nd Digit)</div>
						<div class="colour-options" data-band="2"></div>
					</div>
					<div class="picker-group hidden" id="picker3-digit">
						<div class="picker-label">Band 3 (3rd Digit)</div>
						<div class="colour-options" data-band="3-digit"></div>
					</div>
					<div class="picker-group" id="picker-multiplier">
						<div class="picker-label">Multiplier</div>
						<div class="colour-options" data-band="multiplier"></div>
					</div>
					<div class="picker-group" id="picker-tolerance">
						<div class="picker-label">Tolerance</div>
						<div class="colour-options" data-band="tolerance"></div>
					</div>
					<div class="picker-group hidden" id="picker-tempco">
						<div class="picker-label">Temp Coefficient</div>
						<div class="colour-options" data-band="tempco"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="label">Result</span>
			</div>
			<div class="panel-content">
				<div class="result-box">
					<div class="result-value" id="resultValue">1 kΩ</div>
					<div class="result-tolerance" id="resultTolerance">±5%</div>
					<div class="result-range" id="resultRange">950 Ω - 1.05 kΩ</div>
					<div class="result-temp hidden" id="resultTemp"></div>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="label">Calculate from Value</span>
			</div>
			<div class="panel-content">
				<div class="input-mode">
					<div class="input-row">
						<div class="input-group">
							<label for="valueInput">Resistance Value</label>
							<input type="text" id="valueInput" placeholder="e.g., 4700 or 4.7k">
						</div>
						<div class="input-group" style="max-width: 120px;">
							<label for="toleranceSelect">Tolerance</label>
							<select id="toleranceSelect">
								<option value="1">±1%</option>
								<option value="2">±2%</option>
								<option value="0.5">±0.5%</option>
								<option value="0.25">±0.25%</option>
								<option value="0.1">±0.1%</option>
								<option value="5" selected>±5%</option>
								<option value="10">±10%</option>
							</select>
						</div>
						<button class="calc-btn" onclick="calculateFromValue()">Calculate</button>
					</div>
				</div>
			</div>
		</div>

		<div class="panel">
			<div class="panel-header">
				<span class="label">Colour Code Reference</span>
			</div>
			<div class="panel-content">
				<table class="reference-table">
					<thead>
						<tr>
							<th>Colour</th>
							<th>Digit</th>
							<th>Multiplier</th>
							<th>Tolerance</th>
							<th>Temp Coef</th>
						</tr>
					</thead>
					<tbody id="referenceBody">
					</tbody>
				</table>
			</div>
		</div>

		<a href="/" class="back-link">← Back to home</a>
	</div>

	<script>
		const colourData = {
			black:  { digit: 0, multiplier: 1,          tolerance: null,   tempco: 250,  hex: '#1a1a1a' },
			brown:  { digit: 1, multiplier: 10,         tolerance: 1,      tempco: 100,  hex: '#8b4513' },
			red:    { digit: 2, multiplier: 100,        tolerance: 2,      tempco: 50,   hex: '#dc2626' },
			orange: { digit: 3, multiplier: 1000,       tolerance: 0.05,   tempco: 15,   hex: '#f97316' },
			yellow: { digit: 4, multiplier: 10000,      tolerance: 0.02,   tempco: 25,   hex: '#fbbf24' },
			green:  { digit: 5, multiplier: 100000,     tolerance: 0.5,    tempco: 20,   hex: '#22c55e' },
			blue:   { digit: 6, multiplier: 1000000,    tolerance: 0.25,   tempco: 10,   hex: '#3b82f6' },
			violet: { digit: 7, multiplier: 10000000,   tolerance: 0.1,    tempco: 5,    hex: '#8b5cf6' },
			grey:   { digit: 8, multiplier: 100000000,  tolerance: 0.01,   tempco: 1,    hex: '#6b7280' },
			white:  { digit: 9, multiplier: 1000000000, tolerance: null,   tempco: null, hex: '#f5f5f5' },
			gold:   { digit: null, multiplier: 0.1,     tolerance: 5,      tempco: null, hex: '#d4a017' },
			silver: { digit: null, multiplier: 0.01,    tolerance: 10,     tempco: null, hex: '#c0c0c0' },
			none:   { digit: null, multiplier: null,    tolerance: 20,     tempco: null, hex: 'transparent' }
		};

		const digitColours = ['black', 'brown', 'red', 'orange', 'yellow', 'green', 'blue', 'violet', 'grey', 'white'];
		const multiplierColours = ['black', 'brown', 'red', 'orange', 'yellow', 'green', 'blue', 'violet', 'grey', 'white', 'gold', 'silver'];
		const toleranceColours = ['brown', 'red', 'orange', 'yellow', 'green', 'blue', 'violet', 'grey', 'gold', 'silver', 'none'];
		const tempcoColours = ['black', 'brown', 'red', 'orange', 'yellow', 'green', 'blue', 'violet', 'grey'];

		let numBands = 4;
		let selectedBands = {
			1: 'brown',
			2: 'black',
			3: 'red',      // multiplier for 3/4 band, 3rd digit for 5/6 band
			4: 'gold',     // tolerance for 4 band, multiplier for 5/6 band
			5: 'gold',     // tolerance for 5 band
			6: 'brown'     // tempco for 6 band
		};

		function initColourPickers() {
			// Band 1 (1st digit - no black for first band)
			const picker1 = document.querySelector('[data-band="1"]');
			picker1.innerHTML = '';
			digitColours.slice(1).forEach(c => {
				picker1.appendChild(createColourBtn(c, '1'));
			});

			// Band 2 (2nd digit)
			const picker2 = document.querySelector('[data-band="2"]');
			picker2.innerHTML = '';
			digitColours.forEach(c => {
				picker2.appendChild(createColourBtn(c, '2'));
			});

			// Band 3 digit (for 5/6 band)
			const picker3digit = document.querySelector('[data-band="3-digit"]');
			picker3digit.innerHTML = '';
			digitColours.forEach(c => {
				picker3digit.appendChild(createColourBtn(c, '3-digit'));
			});

			// Multiplier
			const pickerMult = document.querySelector('[data-band="multiplier"]');
			pickerMult.innerHTML = '';
			multiplierColours.forEach(c => {
				pickerMult.appendChild(createColourBtn(c, 'multiplier'));
			});

			// Tolerance
			const pickerTol = document.querySelector('[data-band="tolerance"]');
			pickerTol.innerHTML = '';
			toleranceColours.forEach(c => {
				pickerTol.appendChild(createColourBtn(c, 'tolerance'));
			});

			// Temp coefficient
			const pickerTemp = document.querySelector('[data-band="tempco"]');
			pickerTemp.innerHTML = '';
			tempcoColours.forEach(c => {
				pickerTemp.appendChild(createColourBtn(c, 'tempco'));
			});

			updateSelectedStates();
		}

		function createColourBtn(colour, bandType) {
			const btn = document.createElement('button');
			btn.className = 'colour-btn';
			btn.dataset.colour = colour;
			btn.dataset.bandType = bandType;
			btn.title = colour.charAt(0).toUpperCase() + colour.slice(1);
			btn.style.background = getBandStyle(colour);
			btn.addEventListener('click', () => selectColour(colour, bandType));
			return btn;
		}

		function selectColour(colour, bandType) {
			// Map band type to actual band number based on numBands
			let bandNum;
			if (bandType === '1') bandNum = 1;
			else if (bandType === '2') bandNum = 2;
			else if (bandType === '3-digit') bandNum = 3;
			else if (bandType === 'multiplier') {
				bandNum = (numBands <= 4) ? 3 : 4;
			}
			else if (bandType === 'tolerance') {
				bandNum = (numBands === 3) ? null : (numBands === 4) ? 4 : 5;
			}
			else if (bandType === 'tempco') {
				bandNum = 6;
			}

			if (bandNum) {
				selectedBands[bandNum] = colour;
			} else if (bandType === 'tolerance' && numBands === 3) {
				// 3-band has no tolerance band displayed, but we track it
				selectedBands['tol'] = colour;
			}

			updateSelectedStates();
			updateResistor();
			calculateResistance();
		}

		function updateSelectedStates() {
			document.querySelectorAll('.colour-btn').forEach(btn => {
				btn.classList.remove('selected');
			});

			// Mark selected colours
			const band1Sel = selectedBands[1];
			const band2Sel = selectedBands[2];

			document.querySelector(`[data-band="1"] [data-colour="${band1Sel}"]`)?.classList.add('selected');
			document.querySelector(`[data-band="2"] [data-colour="${band2Sel}"]`)?.classList.add('selected');

			if (numBands >= 5) {
				const band3Sel = selectedBands[3];
				document.querySelector(`[data-band="3-digit"] [data-colour="${band3Sel}"]`)?.classList.add('selected');
			}

			// Multiplier
			const multBand = (numBands <= 4) ? selectedBands[3] : selectedBands[4];
			document.querySelector(`[data-band="multiplier"] [data-colour="${multBand}"]`)?.classList.add('selected');

			// Tolerance
			const tolBand = (numBands === 3) ? (selectedBands['tol'] || 'none') :
			                (numBands === 4) ? selectedBands[4] : selectedBands[5];
			document.querySelector(`[data-band="tolerance"] [data-colour="${tolBand}"]`)?.classList.add('selected');

			// Temp coefficient
			if (numBands === 6) {
				document.querySelector(`[data-band="tempco"] [data-colour="${selectedBands[6]}"]`)?.classList.add('selected');
			}
		}

		function updateResistor() {
			const band1 = document.getElementById('band1');
			const band2 = document.getElementById('band2');
			const band3 = document.getElementById('band3');
			const band4 = document.getElementById('band4');
			const band5 = document.getElementById('band5');
			const band6 = document.getElementById('band6');

			band1.style.background = getBandStyle(selectedBands[1]);
			band2.style.background = getBandStyle(selectedBands[2]);

			if (numBands === 3) {
				band3.style.background = getBandStyle(selectedBands[3]);
				band3.classList.remove('tolerance', 'hidden');
				band4.classList.add('hidden');
				band5.classList.add('hidden');
				band6.classList.add('hidden');
			} else if (numBands === 4) {
				band3.style.background = getBandStyle(selectedBands[3]);
				band3.classList.remove('tolerance', 'hidden');
				band4.style.background = getBandStyle(selectedBands[4]);
				band4.classList.remove('hidden');
				band4.classList.add('tolerance');
				band5.classList.add('hidden');
				band6.classList.add('hidden');
			} else if (numBands === 5) {
				band3.style.background = getBandStyle(selectedBands[3]);
				band3.classList.remove('tolerance', 'hidden');
				band4.style.background = getBandStyle(selectedBands[4]);
				band4.classList.remove('hidden', 'tolerance');
				band5.style.background = getBandStyle(selectedBands[5]);
				band5.classList.remove('hidden');
				band5.classList.add('tolerance');
				band6.classList.add('hidden');
			} else if (numBands === 6) {
				band3.style.background = getBandStyle(selectedBands[3]);
				band3.classList.remove('tolerance', 'hidden');
				band4.style.background = getBandStyle(selectedBands[4]);
				band4.classList.remove('hidden', 'tolerance');
				band5.style.background = getBandStyle(selectedBands[5]);
				band5.classList.remove('hidden');
				band5.classList.add('tolerance');
				band6.style.background = getBandStyle(selectedBands[6]);
				band6.classList.remove('hidden');
				band6.classList.add('temp-coef');
			}
		}

		function getBandStyle(colour) {
			if (colour === 'gold') return 'linear-gradient(135deg, #d4a017, #f4c430, #d4a017)';
			if (colour === 'silver') return 'linear-gradient(135deg, #a0a0a0, #d0d0d0, #a0a0a0)';
			if (colour === 'none') return 'transparent';
			return `var(--band-${colour})`;
		}

		function calculateResistance() {
			let value, tolerance, tempco = null;

			if (numBands === 3) {
				const d1 = colourData[selectedBands[1]].digit;
				const d2 = colourData[selectedBands[2]].digit;
				const mult = colourData[selectedBands[3]].multiplier;
				value = (d1 * 10 + d2) * mult;
				tolerance = 20; // 3-band typically ±20%
			} else if (numBands === 4) {
				const d1 = colourData[selectedBands[1]].digit;
				const d2 = colourData[selectedBands[2]].digit;
				const mult = colourData[selectedBands[3]].multiplier;
				tolerance = colourData[selectedBands[4]].tolerance || 20;
				value = (d1 * 10 + d2) * mult;
			} else if (numBands === 5) {
				const d1 = colourData[selectedBands[1]].digit;
				const d2 = colourData[selectedBands[2]].digit;
				const d3 = colourData[selectedBands[3]].digit;
				const mult = colourData[selectedBands[4]].multiplier;
				tolerance = colourData[selectedBands[5]].tolerance || 20;
				value = (d1 * 100 + d2 * 10 + d3) * mult;
			} else if (numBands === 6) {
				const d1 = colourData[selectedBands[1]].digit;
				const d2 = colourData[selectedBands[2]].digit;
				const d3 = colourData[selectedBands[3]].digit;
				const mult = colourData[selectedBands[4]].multiplier;
				tolerance = colourData[selectedBands[5]].tolerance || 20;
				tempco = colourData[selectedBands[6]].tempco;
				value = (d1 * 100 + d2 * 10 + d3) * mult;
			}

			displayResult(value, tolerance, tempco);
		}

		function displayResult(value, tolerance, tempco) {
			const resultValue = document.getElementById('resultValue');
			const resultTolerance = document.getElementById('resultTolerance');
			const resultRange = document.getElementById('resultRange');
			const resultTemp = document.getElementById('resultTemp');

			resultValue.textContent = formatResistance(value);
			resultTolerance.textContent = `±${tolerance}%`;

			const minVal = value * (1 - tolerance / 100);
			const maxVal = value * (1 + tolerance / 100);
			resultRange.textContent = `${formatResistance(minVal)} - ${formatResistance(maxVal)}`;

			if (tempco !== null) {
				resultTemp.textContent = `Temperature Coefficient: ${tempco} ppm/°C`;
				resultTemp.classList.remove('hidden');
			} else {
				resultTemp.classList.add('hidden');
			}
		}

		function formatResistance(value) {
			if (value >= 1e9) return (value / 1e9).toFixed(2).replace(/\.?0+$/, '') + ' GΩ';
			if (value >= 1e6) return (value / 1e6).toFixed(2).replace(/\.?0+$/, '') + ' MΩ';
			if (value >= 1e3) return (value / 1e3).toFixed(2).replace(/\.?0+$/, '') + ' kΩ';
			if (value >= 1) return value.toFixed(2).replace(/\.?0+$/, '') + ' Ω';
			return (value * 1000).toFixed(2).replace(/\.?0+$/, '') + ' mΩ';
		}

		function setBandCount(count) {
			numBands = count;

			document.querySelectorAll('.band-btn').forEach(btn => {
				btn.classList.toggle('active', parseInt(btn.dataset.bands) === count);
			});

			// Show/hide pickers
			document.getElementById('picker3-digit').classList.toggle('hidden', count < 5);
			document.getElementById('picker-tolerance').classList.toggle('hidden', count < 4);
			document.getElementById('picker-tempco').classList.toggle('hidden', count < 6);

			// Update picker labels
			if (count <= 4) {
				document.querySelector('#picker-multiplier .picker-label').textContent = 'Band 3 (Multiplier)';
			} else {
				document.querySelector('#picker-multiplier .picker-label').textContent = 'Band 4 (Multiplier)';
			}

			updateSelectedStates();
			updateResistor();
			calculateResistance();
		}

		function calculateFromValue() {
			const input = document.getElementById('valueInput').value.trim().toLowerCase();
			const tolerance = parseFloat(document.getElementById('toleranceSelect').value);

			// Parse input value
			let value;
			const match = input.match(/^([\d.]+)\s*(k|m|g|r)?(?:ohm|Ω)?s?$/i);
			if (match) {
				value = parseFloat(match[1]);
				const suffix = match[2]?.toLowerCase();
				if (suffix === 'k') value *= 1000;
				else if (suffix === 'm') value *= 1000000;
				else if (suffix === 'g') value *= 1000000000;
			} else {
				value = parseFloat(input);
			}

			if (isNaN(value) || value <= 0) {
				alert('Please enter a valid resistance value');
				return;
			}

			// Find best band combination
			const bands = findBandsForValue(value, tolerance);
			if (bands) {
				Object.assign(selectedBands, bands);
				updateSelectedStates();
				updateResistor();
				calculateResistance();
			}
		}

		function findBandsForValue(targetValue, tolerance) {
			// Determine appropriate number of bands based on precision needed
			let useDigits = 2;
			if (numBands >= 5) useDigits = 3;

			// Find the significant figures and multiplier
			let sigFigs, multiplier, multColour;

			if (useDigits === 2) {
				// 2 significant figures (3/4 band)
				for (let m = 0; m < multiplierColours.length; m++) {
					const mColour = multiplierColours[m];
					const mValue = colourData[mColour].multiplier;
					if (mValue === null) continue;

					const sf = targetValue / mValue;
					if (sf >= 10 && sf < 100 && Math.abs(sf - Math.round(sf)) < 0.01) {
						sigFigs = Math.round(sf);
						multiplier = mValue;
						multColour = mColour;
						break;
					}
				}
			} else {
				// 3 significant figures (5/6 band)
				for (let m = 0; m < multiplierColours.length; m++) {
					const mColour = multiplierColours[m];
					const mValue = colourData[mColour].multiplier;
					if (mValue === null) continue;

					const sf = targetValue / mValue;
					if (sf >= 100 && sf < 1000 && Math.abs(sf - Math.round(sf)) < 0.01) {
						sigFigs = Math.round(sf);
						multiplier = mValue;
						multColour = mColour;
						break;
					}
				}
			}

			if (!sigFigs) {
				alert('Cannot represent this value with standard colour bands');
				return null;
			}

			// Find tolerance colour
			let tolColour = 'gold'; // default
			for (const c of toleranceColours) {
				if (colourData[c].tolerance === tolerance) {
					tolColour = c;
					break;
				}
			}

			// Build band colours
			const digits = sigFigs.toString().split('').map(Number);

			if (useDigits === 2) {
				return {
					1: digitColours[digits[0]],
					2: digitColours[digits[1]],
					3: multColour,
					4: tolColour,
					5: tolColour,
					6: 'brown'
				};
			} else {
				return {
					1: digitColours[digits[0]],
					2: digitColours[digits[1]],
					3: digitColours[digits[2]],
					4: multColour,
					5: tolColour,
					6: 'brown'
				};
			}
		}

		function buildReferenceTable() {
			const tbody = document.getElementById('referenceBody');
			tbody.innerHTML = '';

			const colours = ['black', 'brown', 'red', 'orange', 'yellow', 'green', 'blue', 'violet', 'grey', 'white', 'gold', 'silver'];

			colours.forEach(colour => {
				const data = colourData[colour];
				const row = document.createElement('tr');

				const colourCell = document.createElement('td');
				colourCell.innerHTML = `<div class="colour-swatch" style="background: ${getBandStyle(colour)};"></div> ${colour.charAt(0).toUpperCase() + colour.slice(1)}`;

				const digitCell = document.createElement('td');
				digitCell.textContent = data.digit !== null ? data.digit : '-';

				const multCell = document.createElement('td');
				if (data.multiplier !== null) {
					if (data.multiplier >= 1e9) multCell.textContent = '×' + (data.multiplier / 1e9) + 'G';
					else if (data.multiplier >= 1e6) multCell.textContent = '×' + (data.multiplier / 1e6) + 'M';
					else if (data.multiplier >= 1e3) multCell.textContent = '×' + (data.multiplier / 1e3) + 'k';
					else if (data.multiplier >= 1) multCell.textContent = '×' + data.multiplier;
					else multCell.textContent = '×' + data.multiplier;
				} else {
					multCell.textContent = '-';
				}

				const tolCell = document.createElement('td');
				tolCell.textContent = data.tolerance !== null ? `±${data.tolerance}%` : '-';

				const tempCell = document.createElement('td');
				tempCell.textContent = data.tempco !== null ? `${data.tempco} ppm` : '-';

				row.appendChild(colourCell);
				row.appendChild(digitCell);
				row.appendChild(multCell);
				row.appendChild(tolCell);
				row.appendChild(tempCell);
				tbody.appendChild(row);
			});
		}

		// Event listeners
		document.querySelectorAll('.band-btn[data-bands]').forEach(btn => {
			btn.addEventListener('click', () => setBandCount(parseInt(btn.dataset.bands)));
		});

		document.getElementById('valueInput').addEventListener('keypress', (e) => {
			if (e.key === 'Enter') calculateFromValue();
		});

		// Initialize
		initColourPickers();
		updateResistor();
		calculateResistance();
		buildReferenceTable();
	</script>
</body>
</html>
