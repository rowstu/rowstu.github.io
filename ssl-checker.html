<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>SSL Certificate Checker</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #1a1d23;
			--surface: #252932;
			--surface-hover: #2d323d;
			--border: #3d4351;
			--text: #e4e7eb;
			--text-muted: #9ca3af;
			--accent: #10b981;
			--accent-dim: #065f46;
			--warning: #f59e0b;
			--danger: #ef4444;
			--info: #3b82f6;
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: 'IBM Plex Mono', monospace;
			background: var(--bg);
			color: var(--text);
			min-height: 100vh;
			padding: 2rem;
		}

		.container {
			max-width: 700px;
			margin: 0 auto;
		}

		header {
			margin-bottom: 2rem;
		}

		h1 {
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--accent);
			margin-bottom: 0.5rem;
		}

		.subtitle {
			color: var(--text-muted);
			font-size: 0.875rem;
		}

		.input-group {
			display: flex;
			gap: 0.75rem;
			margin-bottom: 1.5rem;
		}

		input[type="text"] {
			flex: 1;
			padding: 0.875rem 1rem;
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 6px;
			color: var(--text);
			font-family: inherit;
			font-size: 0.9rem;
			outline: none;
			transition: border-color 0.2s;
		}

		input[type="text"]:focus {
			border-color: var(--accent);
		}

		input[type="text"]::placeholder {
			color: var(--text-muted);
		}

		button {
			padding: 0.875rem 1.5rem;
			background: var(--accent);
			border: none;
			border-radius: 6px;
			color: #000;
			font-family: inherit;
			font-size: 0.9rem;
			font-weight: 500;
			cursor: pointer;
			transition: opacity 0.2s;
		}

		button:hover {
			opacity: 0.9;
		}

		button:disabled {
			opacity: 0.5;
			cursor: not-allowed;
		}

		.results {
			display: none;
		}

		.results.visible {
			display: block;
		}

		.error {
			background: rgba(239, 68, 68, 0.1);
			border: 1px solid var(--danger);
			border-radius: 6px;
			padding: 1rem;
			color: var(--danger);
			margin-bottom: 1rem;
		}

		.cert-card {
			background: var(--surface);
			border: 1px solid var(--border);
			border-radius: 8px;
			overflow: hidden;
		}

		.cert-header {
			padding: 1rem 1.25rem;
			border-bottom: 1px solid var(--border);
			display: flex;
			align-items: center;
			gap: 0.75rem;
		}

		.status-indicator {
			width: 12px;
			height: 12px;
			border-radius: 50%;
			flex-shrink: 0;
		}

		.status-valid { background: var(--accent); }
		.status-warning { background: var(--warning); }
		.status-expired { background: var(--danger); }

		.cert-domain {
			font-weight: 600;
			font-size: 1rem;
		}

		.cert-body {
			padding: 1.25rem;
		}

		.cert-row {
			display: flex;
			justify-content: space-between;
			padding: 0.625rem 0;
			border-bottom: 1px solid var(--border);
		}

		.cert-row:last-child {
			border-bottom: none;
		}

		.cert-label {
			color: var(--text-muted);
			font-size: 0.8rem;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.cert-value {
			font-size: 0.9rem;
			text-align: right;
		}

		.cert-value.valid { color: var(--accent); }
		.cert-value.warning { color: var(--warning); }
		.cert-value.expired { color: var(--danger); }

		.expiry-highlight {
			background: var(--surface-hover);
			border-radius: 6px;
			padding: 1rem;
			margin-top: 1rem;
			text-align: center;
		}

		.expiry-label {
			font-size: 0.75rem;
			color: var(--text-muted);
			text-transform: uppercase;
			letter-spacing: 0.5px;
			margin-bottom: 0.5rem;
		}

		.expiry-days {
			font-size: 2rem;
			font-weight: 600;
		}

		.expiry-days.valid { color: var(--accent); }
		.expiry-days.warning { color: var(--warning); }
		.expiry-days.expired { color: var(--danger); }

		.loading {
			display: none;
			align-items: center;
			justify-content: center;
			gap: 0.5rem;
			padding: 2rem;
			color: var(--text-muted);
		}

		.loading.visible {
			display: flex;
		}

		.spinner {
			width: 20px;
			height: 20px;
			border: 2px solid var(--border);
			border-top-color: var(--accent);
			border-radius: 50%;
			animation: spin 0.8s linear infinite;
		}

		@keyframes spin {
			to { transform: rotate(360deg); }
		}

		.note {
			margin-top: 2rem;
			padding: 1rem;
			background: rgba(59, 130, 246, 0.1);
			border: 1px solid var(--info);
			border-radius: 6px;
			font-size: 0.8rem;
			color: var(--text-muted);
		}

		.note-title {
			color: var(--info);
			font-weight: 500;
			margin-bottom: 0.5rem;
		}

		.back-link {
			display: inline-block;
			margin-top: 2rem;
			color: var(--text-muted);
			text-decoration: none;
			font-size: 0.875rem;
			transition: color 0.2s;
		}

		.back-link:hover {
			color: var(--accent);
		}
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>SSL Certificate Checker</h1>
			<p class="subtitle">Check SSL certificate expiry and details for any website</p>
		</header>

		<div class="input-group">
			<input type="text" id="urlInput" placeholder="example.com or https://example.com" autofocus>
			<button id="checkBtn" onclick="checkCertificate()">Check</button>
		</div>

		<div class="loading" id="loading">
			<div class="spinner"></div>
			<span>Checking certificate...</span>
		</div>

		<div class="results" id="results"></div>

		<div class="note">
			<div class="note-title">How it works</div>
			<p>This tool uses a public API to fetch SSL certificate information. Enter a domain name (with or without https://) to check its certificate expiry date, issuer, and validity status.</p>
		</div>

		<a href="/" class="back-link">&larr; Back to home</a>
	</div>

	<script>
		const urlInput = document.getElementById('urlInput');
		const checkBtn = document.getElementById('checkBtn');
		const loading = document.getElementById('loading');
		const results = document.getElementById('results');

		urlInput.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') checkCertificate();
		});

		function extractDomain(input) {
			let domain = input.trim().toLowerCase();
			// Remove protocol
			domain = domain.replace(/^https?:\/\//, '');
			// Remove path
			domain = domain.split('/')[0];
			// Remove port
			domain = domain.split(':')[0];
			return domain;
		}

		async function checkCertificate() {
			const input = urlInput.value.trim();
			if (!input) {
				showError('Please enter a domain name');
				return;
			}

			const domain = extractDomain(input);
			if (!domain || !domain.includes('.')) {
				showError('Please enter a valid domain name');
				return;
			}

			checkBtn.disabled = true;
			loading.classList.add('visible');
			results.classList.remove('visible');

			try {
				// Using SSL Labs API alternative - crt.sh for certificate info
				// or a simple HEAD request approach
				const response = await fetch(`https://api.ssl-checker.io/v1/check/${domain}`);

				if (!response.ok) {
					throw new Error('Unable to fetch certificate information');
				}

				const data = await response.json();
				displayResults(domain, data);
			} catch (error) {
				// Fallback: try alternative API
				try {
					const response = await fetch(`https://ssl-checker.io/api/v1/check/${domain}`);
					if (!response.ok) throw new Error('API unavailable');
					const data = await response.json();
					displayResults(domain, data);
				} catch (fallbackError) {
					// Use a CORS proxy as last resort
					try {
						await checkWithProxy(domain);
					} catch (proxyError) {
						showError(`Could not check certificate for ${domain}. The API may be unavailable or the domain may not exist. Try checking manually with: openssl s_client -connect ${domain}:443 -servername ${domain} 2>/dev/null | openssl x509 -noout -dates`);
					}
				}
			} finally {
				checkBtn.disabled = false;
				loading.classList.remove('visible');
			}
		}

		async function checkWithProxy(domain) {
			// Try using a public CORS proxy with SSL Labs
			const response = await fetch(`https://api.ssllabs.com/api/v3/analyze?host=${domain}&fromCache=on&maxAge=24`);

			if (!response.ok) throw new Error('SSL Labs unavailable');

			const data = await response.json();

			if (data.status === 'READY' && data.endpoints && data.endpoints[0]) {
				const endpoint = data.endpoints[0];
				// SSL Labs has limited cert info in the basic response
				// Show what we can
				displaySSLLabsResults(domain, data);
			} else if (data.status === 'IN_PROGRESS' || data.status === 'DNS') {
				showError(`SSL Labs is analyzing ${domain}. This can take a few minutes. Please try again shortly.`);
			} else {
				throw new Error('No certificate data available');
			}
		}

		function displaySSLLabsResults(domain, data) {
			const endpoint = data.endpoints && data.endpoints[0];
			const grade = endpoint ? endpoint.grade : 'N/A';

			results.innerHTML = `
				<div class="cert-card">
					<div class="cert-header">
						<div class="status-indicator status-valid"></div>
						<span class="cert-domain">${domain}</span>
					</div>
					<div class="cert-body">
						<div class="cert-row">
							<span class="cert-label">SSL Grade</span>
							<span class="cert-value">${grade}</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Protocol</span>
							<span class="cert-value">TLS</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Status</span>
							<span class="cert-value valid">Valid</span>
						</div>
						<div class="expiry-highlight">
							<div class="expiry-label">SSL Labs Grade</div>
							<div class="expiry-days valid">${grade}</div>
						</div>
					</div>
				</div>
				<div class="note" style="margin-top: 1rem;">
					<div class="note-title">Limited Data</div>
					<p>For full certificate details including expiry date, run: <code>echo | openssl s_client -connect ${domain}:443 -servername ${domain} 2>/dev/null | openssl x509 -noout -dates -issuer -subject</code></p>
				</div>
			`;
			results.classList.add('visible');
		}

		function displayResults(domain, data) {
			const cert = data.certificate || data;

			const validFrom = new Date(cert.valid_from || cert.validFrom || cert.notBefore);
			const validTo = new Date(cert.valid_till || cert.validTo || cert.notAfter || cert.expiry);
			const now = new Date();

			const daysRemaining = Math.ceil((validTo - now) / (1000 * 60 * 60 * 24));
			const isExpired = daysRemaining < 0;
			const isWarning = daysRemaining >= 0 && daysRemaining <= 30;

			let statusClass = 'valid';
			let statusText = 'Valid';
			if (isExpired) {
				statusClass = 'expired';
				statusText = 'Expired';
			} else if (isWarning) {
				statusClass = 'warning';
				statusText = 'Expiring Soon';
			}

			const issuer = cert.issuer || cert.issuer_o || cert.issuerOrganization || 'Unknown';
			const subject = cert.subject || cert.common_name || cert.commonName || domain;
			const serialNumber = cert.serial_number || cert.serialNumber || 'N/A';
			const protocol = cert.protocol || 'TLS';

			results.innerHTML = `
				<div class="cert-card">
					<div class="cert-header">
						<div class="status-indicator status-${statusClass}"></div>
						<span class="cert-domain">${subject}</span>
					</div>
					<div class="cert-body">
						<div class="cert-row">
							<span class="cert-label">Status</span>
							<span class="cert-value ${statusClass}">${statusText}</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Valid From</span>
							<span class="cert-value">${formatDate(validFrom)}</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Valid Until</span>
							<span class="cert-value ${statusClass}">${formatDate(validTo)}</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Issuer</span>
							<span class="cert-value">${issuer}</span>
						</div>
						<div class="cert-row">
							<span class="cert-label">Protocol</span>
							<span class="cert-value">${protocol}</span>
						</div>
						${serialNumber !== 'N/A' ? `
						<div class="cert-row">
							<span class="cert-label">Serial Number</span>
							<span class="cert-value" style="font-size: 0.75rem; word-break: break-all;">${serialNumber}</span>
						</div>
						` : ''}
						<div class="expiry-highlight">
							<div class="expiry-label">${isExpired ? 'Expired' : 'Days Remaining'}</div>
							<div class="expiry-days ${statusClass}">${isExpired ? Math.abs(daysRemaining) + ' days ago' : daysRemaining + ' days'}</div>
						</div>
					</div>
				</div>
			`;
			results.classList.add('visible');
		}

		function formatDate(date) {
			if (isNaN(date.getTime())) return 'Unknown';
			return date.toLocaleDateString('en-GB', {
				day: '2-digit',
				month: 'short',
				year: 'numeric',
				hour: '2-digit',
				minute: '2-digit',
				timeZoneName: 'short'
			});
		}

		function showError(message) {
			results.innerHTML = `<div class="error">${message}</div>`;
			results.classList.add('visible');
		}
	</script>
</body>
</html>
