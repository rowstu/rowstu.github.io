<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Linux from scratch // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>Linux from scratch</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/linuxscratch/>Linuxscratch</a></div><div class="card markdown-content"><p>Experimenting with building bare bones Linux OS without having to build the Linux from scratch sources.</p><h3 id=1-prepare-the-environment><strong>1. Prepare the Environment</strong></h3><ul><li>Boot into a live Linux environment using an ArchLinux, Debian, or RHEL-based ISO.</li><li>Ensure you have tools like <code>fdisk</code>, <code>mkfs</code>, and <code>wget</code> available.</li></ul><hr><h3 id=2-partition-and-format-the-disk><strong>2. Partition and Format the Disk</strong></h3><ol><li><p><strong>Partition the Disk:</strong>
Use <code>fdisk</code> or <code>parted</code> to create:</p><ul><li>Boot Partition (e.g., 1 GB, ext4).</li><li>Root Partition (e.g., 20â€“50 GB, ext4).</li><li>Optional Swap Partition.</li></ul></li><li><p><strong>Format the Partitions:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.ext4 /dev/sdX1  <span style=color:#75715e># Boot</span>
</span></span><span style=display:flex><span>mkfs.ext4 /dev/sdX2  <span style=color:#75715e># Root</span>
</span></span><span style=display:flex><span>mkswap /dev/sdX3     <span style=color:#75715e># Swap</span>
</span></span><span style=display:flex><span>swapon /dev/sdX3
</span></span></code></pre></div></li><li><p><strong>Mount the Partitions:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mount /dev/sdX2 /mnt  <span style=color:#75715e># Mount root</span>
</span></span><span style=display:flex><span>mkdir -p /mnt/boot
</span></span><span style=display:flex><span>mount /dev/sdX1 /mnt/boot  <span style=color:#75715e># Mount boot</span>
</span></span></code></pre></div></li></ol><hr><h3 id=3-download-and-install-the-kernel><strong>3. Download and Install the Kernel</strong></h3><ol><li><p><strong>Download the Kernel:</strong></p><ul><li><p>Go to <a href=https://www.kernel.org/>kernel.org</a> and download the latest stable kernel:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-x.y.z.tar.xz
</span></span></code></pre></div></li></ul></li><li><p><strong>Extract and Copy Kernel Files:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>tar -xvf linux-x.y.z.tar.xz
</span></span><span style=display:flex><span>cd linux-x.y.z
</span></span></code></pre></div></li><li><p><strong>Install the Kernel:</strong></p><ul><li><p>Create directories for the kernel in your root filesystem:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /mnt/boot /mnt/lib/modules
</span></span></code></pre></div></li><li><p>Copy kernel files manually:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>cp arch/x86/boot/bzImage /mnt/boot/vmlinuz-linux
</span></span><span style=display:flex><span>cp -r lib/modules/* /mnt/lib/modules/
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=4-add-a-minimal-init-system><strong>4. Add a Minimal Init System</strong></h3><ol><li><p><strong>Download BusyBox:</strong>
BusyBox provides basic utilities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://busybox.net/downloads/busybox-x.y.z.tar.bz2
</span></span><span style=display:flex><span>tar -xvf busybox-x.y.z.tar.bz2
</span></span><span style=display:flex><span>cd busybox-x.y.z
</span></span></code></pre></div></li><li><p><strong>Build and Install:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>make defconfig
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install CONFIG_PREFIX<span style=color:#f92672>=</span>/mnt
</span></span></code></pre></div></li><li><p><strong>Create Init Scripts:</strong></p><ul><li><p>Add an <code>init</code> script at <code>/mnt/init</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span>mount -t proc none /proc
</span></span><span style=display:flex><span>mount -t sysfs none /sys
</span></span><span style=display:flex><span>mount -t devtmpfs none /dev
</span></span><span style=display:flex><span>/bin/sh
</span></span></code></pre></div></li><li><p>Make it executable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x /mnt/init
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=5-add-essential-gnu-utilities><strong>5. Add Essential GNU Utilities</strong></h3><ol><li><p><strong>Download Coreutils:</strong></p><ul><li><p>Get coreutils from the GNU Project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://ftp.gnu.org/gnu/coreutils/coreutils-x.y.z.tar.xz
</span></span><span style=display:flex><span>tar -xvf coreutils-x.y.z.tar.xz
</span></span><span style=display:flex><span>cd coreutils-x.y.z
</span></span></code></pre></div></li></ul></li><li><p><strong>Build and Install:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --prefix<span style=color:#f92672>=</span>/mnt
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install
</span></span></code></pre></div></li><li><p><strong>Repeat for Other Utilities (Optional):</strong>
Download and install <code>bash</code>, <code>sed</code>, <code>grep</code>, etc., similarly.</p></li></ol><hr><h3 id=6-configure-bootloader><strong>6. Configure Bootloader</strong></h3><ol><li><p><strong>Install GRUB:</strong></p><ul><li><p>Install GRUB to your disk:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>grub-install --root-directory<span style=color:#f92672>=</span>/mnt --target<span style=color:#f92672>=</span>i386-pc /dev/sdX
</span></span></code></pre></div></li></ul></li><li><p><strong>Create a GRUB Configuration:</strong></p><ul><li><p>Add <code>/mnt/boot/grub/grub.cfg</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>set default<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>set timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>menuentry <span style=color:#e6db74>&#34;Minimal Linux&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    linux /boot/vmlinuz-linux root<span style=color:#f92672>=</span>/dev/sdX2 init<span style=color:#f92672>=</span>/init
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=7-finalize-the-system><strong>7. Finalize the System</strong></h3><ol><li><p><strong>Unmount and Reboot:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>umount -R /mnt
</span></span><span style=display:flex><span>reboot
</span></span></code></pre></div></li><li><p><strong>Test the System:</strong>
Boot into your custom-built Linux OS and verify functionality.</p></li></ol></div></div><script src=/assets/shared-nav.js></script></body></html>