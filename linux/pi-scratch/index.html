<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Raspberry Pi from scratch // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>Raspberry Pi from scratch</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/linuxpi-scratch/>Linuxpi Scratch</a></div><div class="card markdown-content"><h3 id=1-prepare-the-sd-card><strong>1. Prepare the SD Card</strong></h3><ol><li><p><strong>Insert the SD Card:</strong></p><ul><li>Insert the SD card into your computer.</li><li>Identify the device name (e.g., <code>/dev/sdX</code>) using <code>lsblk</code> or <code>fdisk -l</code>.</li></ul></li><li><p><strong>Partition the SD Card:</strong></p><ul><li><p>Use <code>fdisk</code> to create:</p><ul><li><strong>Boot Partition:</strong> FAT32, ~128 MB (for the Piâ€™s firmware and kernel).</li><li><strong>Root Partition:</strong> ext4, the remaining space (for the OS).</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>fdisk /dev/sdX
</span></span></code></pre></div><ul><li>Create a partition table (<code>o</code>), then partitions (<code>n</code>), and write (<code>w</code>).</li></ul></li><li><p><strong>Format the Partitions:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mkfs.fat -F32 /dev/sdX1  <span style=color:#75715e># Boot partition</span>
</span></span><span style=display:flex><span>mkfs.ext4 /dev/sdX2      <span style=color:#75715e># Root partition</span>
</span></span></code></pre></div></li><li><p><strong>Mount the Partitions:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /mnt/boot /mnt/root
</span></span><span style=display:flex><span>mount /dev/sdX1 /mnt/boot
</span></span><span style=display:flex><span>mount /dev/sdX2 /mnt/root
</span></span></code></pre></div></li></ol><hr><h3 id=2-obtain-the-raspberry-pi-firmware><strong>2. Obtain the Raspberry Pi Firmware</strong></h3><ol><li><p><strong>Download Firmware Files:</strong></p><ul><li><p>Clone the Raspberry Pi firmware repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git clone --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> https://github.com/raspberrypi/firmware.git
</span></span></code></pre></div></li></ul></li><li><p><strong>Copy Firmware to the Boot Partition:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>cp -r firmware/boot/* /mnt/boot
</span></span></code></pre></div></li></ol><hr><h3 id=3-download-and-install-the-kernel><strong>3. Download and Install the Kernel</strong></h3><ol><li><p><strong>Download Precompiled Kernel:</strong></p><ul><li><p>Use the Raspberry Pi kernel repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>git clone --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> https://github.com/raspberrypi/linux.git
</span></span><span style=display:flex><span>cd linux
</span></span></code></pre></div></li></ul></li><li><p><strong>Copy Kernel and Modules:</strong></p><ul><li><p>Copy the precompiled kernel (<code>kernel7.img</code> or <code>kernel8.img</code> for 64-bit systems):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>cp arch/arm/boot/Image /mnt/boot/kernel7.img
</span></span></code></pre></div></li><li><p>Install modules to the root filesystem:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /mnt/root/lib/modules
</span></span><span style=display:flex><span>cp -r /lib/modules/* /mnt/root/lib/modules/
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=4-add-a-minimal-init-system><strong>4. Add a Minimal Init System</strong></h3><ol><li><p><strong>Download BusyBox:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://busybox.net/downloads/busybox-x.y.z.tar.bz2
</span></span><span style=display:flex><span>tar -xvf busybox-x.y.z.tar.bz2
</span></span><span style=display:flex><span>cd busybox-x.y.z
</span></span></code></pre></div></li><li><p><strong>Build and Install BusyBox:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>make defconfig
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install CONFIG_PREFIX<span style=color:#f92672>=</span>/mnt/root
</span></span></code></pre></div></li><li><p><strong>Create an Init Script:</strong></p><ul><li><p>Add <code>/mnt/root/init</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span>mount -t proc none /proc
</span></span><span style=display:flex><span>mount -t sysfs none /sys
</span></span><span style=display:flex><span>mount -t devtmpfs none /dev
</span></span><span style=display:flex><span>/bin/sh
</span></span></code></pre></div></li><li><p>Make it executable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x /mnt/root/init
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=5-add-essential-filesystem-utilities><strong>5. Add Essential Filesystem Utilities</strong></h3><ol><li><p><strong>Download GNU Core Utilities:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://ftp.gnu.org/gnu/coreutils/coreutils-x.y.z.tar.xz
</span></span><span style=display:flex><span>tar -xvf coreutils-x.y.z.tar.xz
</span></span><span style=display:flex><span>cd coreutils-x.y.z
</span></span></code></pre></div></li><li><p><strong>Build and Install Coreutils:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --prefix<span style=color:#f92672>=</span>/mnt/root
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install
</span></span></code></pre></div></li></ol><hr><h3 id=6-configure-boot><strong>6. Configure Boot</strong></h3><ol><li><p><strong>Modify <code>config.txt</code>:</strong></p><ul><li><p>Edit <code>/mnt/boot/config.txt</code> to set the kernel and basic options:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>kernel</span><span style=color:#f92672>=</span><span style=color:#e6db74>kernel7.img</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>gpu_mem</span><span style=color:#f92672>=</span><span style=color:#e6db74>16</span>
</span></span></code></pre></div></li></ul></li><li><p><strong>Add <code>cmdline.txt</code>:</strong></p><ul><li><p>Create <code>/mnt/boot/cmdline.txt</code> with the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-txt data-lang=txt><span style=display:flex><span>root=/dev/mmcblk0p2 rootfstype=ext4 rw init=/init console=serial0,115200 console=tty1
</span></span></code></pre></div></li></ul></li></ol><hr><h3 id=7-finalize-the-sd-card><strong>7. Finalize the SD Card</strong></h3><ol><li><p><strong>Unmount Partitions:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>umount /mnt/boot /mnt/root
</span></span></code></pre></div></li><li><p><strong>Insert the SD Card into the Raspberry Pi and Boot:</strong></p><ul><li>Place the SD card in your Raspberry Pi.</li><li>Power on the Raspberry Pi and verify booting into the minimal environment.</li></ul></li></ol></div></div><script src=/assets/shared-nav.js></script></body></html>