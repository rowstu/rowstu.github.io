<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Vagrant – Notes, Procedures, and Best Practices // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>Vagrant – Notes, Procedures, and Best Practices</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/vagrantvagrant/>Vagrantvagrant</a></div><div class="card markdown-content"><p>Vagrant is a tool for building, configuring, and managing reproducible development environments. It provides a consistent workflow on top of virtualization and container technologies, allowing developers and operators to spin up identical environments across different machines.</p><h3 id=core-terminology>Core Terminology</h3><ul><li><strong>Box</strong>: A packaged base image (e.g. Ubuntu, CentOS) used to create VMs.</li><li><strong>Provider</strong>: The backend that runs the environment (VirtualBox, libvirt, VMware, Hyper-V, Docker).</li><li><strong>Vagrantfile</strong>: The declarative configuration file that defines how the environment is built.</li><li><strong>Provisioner</strong>: A tool or script used to configure the VM after it boots (shell, Ansible, Puppet, Chef).</li><li><strong>Synced Folder</strong>: A directory shared between host and guest.</li><li><strong>Environment</strong>: A directory containing a Vagrantfile and associated state.</li><li><strong>Multi-machine Environment</strong>: A single Vagrantfile defining multiple VMs.</li></ul><h3 id=why-vagrant-is-useful>Why Vagrant Is Useful</h3><ul><li>Eliminates &ldquo;works on my machine&rdquo; problems</li><li>Standardizes dev and test environments</li><li>Speeds up onboarding</li><li>Encourages infrastructure-as-code practices</li></ul><hr><h2 id=2-installation-and-setup>2. Installation and Setup</h2><h3 id=general-requirements>General Requirements</h3><ul><li>A supported host OS (Linux, macOS, Windows)</li><li>A virtualization provider</li><li>Hardware virtualization enabled (Intel VT-x / AMD-V)</li></ul><h3 id=install-vagrant>Install Vagrant</h3><h4 id=linux-debianubuntu>Linux (Debian/Ubuntu)</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install vagrant
</span></span></code></pre></div><h4 id=rhel--rocky--alma>RHEL / Rocky / Alma</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dnf install vagrant
</span></span></code></pre></div><h4 id=macos>macOS</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>brew install --cask vagrant
</span></span></code></pre></div><h4 id=windows>Windows</h4><ul><li>Download installer from HashiCorp</li><li>Ensure Hyper-V or VirtualBox is configured correctly</li></ul><h3 id=install-a-provider>Install a Provider</h3><h4 id=virtualbox-most-common>VirtualBox (most common)</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install virtualbox
</span></span></code></pre></div><h4 id=libvirt-linux-native-preferred-for-performance>libvirt (Linux-native, preferred for performance)</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install libvirt-daemon-system libvirt-clients vagrant-libvirt
</span></span></code></pre></div><h3 id=useful-plugins>Useful Plugins</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vagrant plugin install vagrant-vbguest
</span></span><span style=display:flex><span>vagrant plugin install vagrant-hostmanager
</span></span><span style=display:flex><span>vagrant plugin install vagrant-disksize
</span></span></code></pre></div><hr><h2 id=3-vagrantfile-structure>3. Vagrantfile Structure</h2><h3 id=basic-vagrantfile>Basic Vagrantfile</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>Vagrant</span><span style=color:#f92672>.</span>configure(<span style=color:#e6db74>&#34;2&#34;</span>) <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>config<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>box <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ubuntu/jammy64&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h3 id=common-configuration-sections>Common Configuration Sections</h3><h4 id=box-configuration>Box Configuration</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>box <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ubuntu/jammy64&#34;</span>
</span></span><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>box_version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&gt;= 20240101&#34;</span>
</span></span></code></pre></div><h4 id=provider-specific-settings>Provider-Specific Settings</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>provider <span style=color:#e6db74>&#34;virtualbox&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>vb<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  vb<span style=color:#f92672>.</span>memory <span style=color:#f92672>=</span> <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span>  vb<span style=color:#f92672>.</span>cpus <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h4 id=synced-folders>Synced Folders</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>synced_folder <span style=color:#e6db74>&#34;./app&#34;</span>, <span style=color:#e6db74>&#34;/vagrant&#34;</span>, <span style=color:#e6db74>type</span>: <span style=color:#e6db74>&#34;rsync&#34;</span>
</span></span></code></pre></div><h4 id=multi-vm-definition>Multi-VM Definition</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>define <span style=color:#e6db74>&#34;web&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>web<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  web<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>hostname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;web.local&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>define <span style=color:#e6db74>&#34;db&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>db<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  db<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>hostname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;db.local&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><hr><h2 id=4-common-commands>4. Common Commands</h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>vagrant init</code></td><td>Initialize a new Vagrantfile</td></tr><tr><td><code>vagrant up</code></td><td>Create and start the VM</td></tr><tr><td><code>vagrant halt</code></td><td>Stop the VM</td></tr><tr><td><code>vagrant destroy</code></td><td>Destroy the VM</td></tr><tr><td><code>vagrant reload</code></td><td>Restart and reapply config</td></tr><tr><td><code>vagrant ssh</code></td><td>SSH into the VM</td></tr><tr><td><code>vagrant status</code></td><td>Show VM state</td></tr><tr><td><code>vagrant provision</code></td><td>Re-run provisioners</td></tr><tr><td><code>vagrant box list</code></td><td>List installed boxes</td></tr><tr><td><code>vagrant box prune</code></td><td>Remove unused boxes</td></tr></tbody></table><hr><h2 id=5-provisioning>5. Provisioning</h2><h3 id=shell-provisioning>Shell Provisioning</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>provision <span style=color:#e6db74>&#34;shell&#34;</span>, <span style=color:#e6db74>inline</span>: <span style=color:#e6db74>&lt;&lt;-SHELL
</span></span></span><span style=display:flex><span>  apt update
</span></span><span style=display:flex><span>  apt install <span style=color:#f92672>-</span>y nginx
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHELL</span>
</span></span></code></pre></div><p><strong>Best Practices</strong>:</p><ul><li>Make scripts idempotent</li><li>Avoid interactive prompts</li><li>Log output clearly</li></ul><h3 id=ansible-local>Ansible (Local)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>provision <span style=color:#e6db74>&#34;ansible_local&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>ansible<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  ansible<span style=color:#f92672>.</span>playbook <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;playbook.yml&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h3 id=ansible-host-based>Ansible (Host-based)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>provision <span style=color:#e6db74>&#34;ansible&#34;</span> <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>ansible<span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>  ansible<span style=color:#f92672>.</span>playbook <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;playbook.yml&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><p><strong>Recommendations</strong>:</p><ul><li>Prefer Ansible for complex setups</li><li>Keep provisioning logic outside the Vagrantfile</li><li>Use inventory groups for multi-VM setups</li></ul><hr><h2 id=6-networking>6. Networking</h2><h3 id=port-forwarding>Port Forwarding</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>network <span style=color:#e6db74>&#34;forwarded_port&#34;</span>, <span style=color:#e6db74>guest</span>: <span style=color:#ae81ff>80</span>, <span style=color:#e6db74>host</span>: <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><h3 id=private-network-host-only>Private Network (Host-only)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>network <span style=color:#e6db74>&#34;private_network&#34;</span>, <span style=color:#e6db74>ip</span>: <span style=color:#e6db74>&#34;192.168.56.10&#34;</span>
</span></span></code></pre></div><h3 id=public-network-bridged>Public Network (Bridged)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ruby data-lang=ruby><span style=display:flex><span>config<span style=color:#f92672>.</span>vm<span style=color:#f92672>.</span>network <span style=color:#e6db74>&#34;public_network&#34;</span>
</span></span></code></pre></div><p><strong>Best Practices</strong>:</p><ul><li>Use private networks for multi-VM communication</li><li>Avoid public networks unless required</li><li>Keep IP addressing predictable</li></ul><hr><h2 id=7-debugging-and-troubleshooting>7. Debugging and Troubleshooting</h2><h3 id=useful-techniques>Useful Techniques</h3><ul><li><code>vagrant up --debug</code></li><li>Check <code>.vagrant/</code> state directory</li><li>Inspect provider logs (VirtualBox, libvirt)</li></ul><h3 id=common-issues>Common Issues</h3><p><strong>VM Won’t Start</strong></p><ul><li>Check virtualization support</li><li>Ensure provider versions match</li></ul><p><strong>SSH Fails</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>vagrant ssh-config
</span></span></code></pre></div><p><strong>Provisioning Errors</strong></p><ul><li>Re-run with <code>vagrant provision</code></li><li>Test scripts manually inside the VM</li></ul><hr><h2 id=8-version-control-practices>8. Version Control Practices</h2><h3 id=what-to-commit>What to Commit</h3><ul><li><code>Vagrantfile</code></li><li>Provisioning scripts</li><li>Ansible playbooks</li></ul><h3 id=what-not-to-commit>What NOT to Commit</h3><ul><li><code>.vagrant/</code></li><li>Downloaded boxes</li><li>Generated SSH keys</li></ul><h3 id=recommendations>Recommendations</h3><ul><li>Treat Vagrantfile as code</li><li>Use branches for environment changes</li><li>Pin box versions for reproducibility</li></ul><hr><h2 id=9-best-practices-for-long-term-use>9. Best Practices for Long-Term Use</h2><h3 id=environment-hygiene>Environment Hygiene</h3><ul><li>Regularly run <code>vagrant box prune</code></li><li>Destroy unused environments</li></ul><h3 id=performance>Performance</h3><ul><li>Prefer libvirt on Linux</li><li>Use rsync or NFS over default shared folders</li></ul><h3 id=maintainability>Maintainability</h3><ul><li>Keep Vagrantfile minimal</li><li>Push complexity into provisioners</li></ul><h3 id=security>Security</h3><ul><li>Avoid embedding secrets</li><li>Use <code>.env</code> files or Vault integration</li></ul><h3 id=when-not-to-use-vagrant>When NOT to Use Vagrant</h3><ul><li>Production workloads</li><li>Large-scale, long-lived environments</li><li>When containers alone suffice</li></ul></div></div><script src=/assets/shared-nav.js></script></body></html>