<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>VPN // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>VPN</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/tfvpn/>Tfvpn</a></div><div class="card markdown-content"><h1 id=vpn-connections>VPN Connections</h1><p>Setting up Site-to-Site VPN and Client VPN with Terraform.</p><h2 id=site-to-site-vpn>Site-to-Site VPN</h2><h3 id=virtual-private-gateway>Virtual Private Gateway</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_gateway&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  vpc_id          <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  amazon_side_asn <span style=color:#f92672>=</span> <span style=color:#ae81ff>64512</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;main-vgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_gateway_attachment&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  vpc_id         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  vpn_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=customer-gateway>Customer Gateway</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_customer_gateway&#34; &#34;onprem&#34;</span> {
</span></span><span style=display:flex><span>  bgp_asn    <span style=color:#f92672>=</span> <span style=color:#ae81ff>65000</span>
</span></span><span style=display:flex><span>  ip_address <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;203.0.113.10&#34;</span><span style=color:#75715e>  # On-premises router public IP
</span></span></span><span style=display:flex><span>  type       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ipsec.1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;onprem-cgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=vpn-connection>VPN Connection</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_connection&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  vpn_gateway_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  customer_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_customer_gateway</span>.<span style=color:#66d9ef>onprem</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  type                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ipsec.1&#34;</span>
</span></span><span style=display:flex><span>  static_routes_only  <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;onprem-vpn&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=static-routes-vpn>Static Routes VPN</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_connection&#34; &#34;static&#34;</span> {
</span></span><span style=display:flex><span>  vpn_gateway_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  customer_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_customer_gateway</span>.<span style=color:#66d9ef>onprem</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  type                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ipsec.1&#34;</span>
</span></span><span style=display:flex><span>  static_routes_only  <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;static-vpn&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_connection_route&#34; &#34;office&#34;</span> {
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;192.168.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  vpn_connection_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>static</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_connection_route&#34; &#34;datacenter&#34;</span> {
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.100.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  vpn_connection_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>static</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=route-propagation>Route Propagation</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_gateway_route_propagation&#34; &#34;private&#34;</span> {
</span></span><span style=display:flex><span>  count          <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>private</span>)
</span></span><span style=display:flex><span>  vpn_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=vpn-with-transit-gateway>VPN with Transit Gateway</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Main TGW&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;main-tgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_vpn_connection&#34; &#34;tgw&#34;</span> {
</span></span><span style=display:flex><span>  customer_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_customer_gateway</span>.<span style=color:#66d9ef>onprem</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  type                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ipsec.1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;tgw-vpn&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=client-vpn-remote-access>Client VPN (Remote Access)</h2><h3 id=certificate-based-authentication>Certificate-Based Authentication</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Import server certificate
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_acm_certificate&#34; &#34;server&#34;</span> {
</span></span><span style=display:flex><span>  private_key       <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;server.key&#34;</span>)
</span></span><span style=display:flex><span>  certificate_body  <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;server.crt&#34;</span>)
</span></span><span style=display:flex><span>  certificate_chain <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;ca.crt&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vpn-server-cert&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Import client root certificate
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_acm_certificate&#34; &#34;client&#34;</span> {
</span></span><span style=display:flex><span>  private_key       <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;client.key&#34;</span>)
</span></span><span style=display:flex><span>  certificate_body  <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;client.crt&#34;</span>)
</span></span><span style=display:flex><span>  certificate_chain <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;ca.crt&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vpn-client-cert&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_endpoint&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  description            <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Client VPN Endpoint&#34;</span>
</span></span><span style=display:flex><span>  server_certificate_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_acm_certificate</span>.<span style=color:#66d9ef>server</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  client_cidr_block      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.200.0.0/22&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>authentication_options</span> {
</span></span><span style=display:flex><span>    type                       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;certificate-authentication&#34;</span>
</span></span><span style=display:flex><span>    root_certificate_chain_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_acm_certificate</span>.<span style=color:#66d9ef>client</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>connection_log_options</span> {
</span></span><span style=display:flex><span>    enabled               <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    cloudwatch_log_group  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_group</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>    cloudwatch_log_stream <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_stream</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dns_servers <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;10.0.0.2&#34;</span>]
</span></span><span style=display:flex><span>  split_tunnel <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client-vpn&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=active-directory-authentication>Active Directory Authentication</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_endpoint&#34; &#34;ad&#34;</span> {
</span></span><span style=display:flex><span>  description            <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Client VPN with AD&#34;</span>
</span></span><span style=display:flex><span>  server_certificate_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_acm_certificate</span>.<span style=color:#66d9ef>server</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  client_cidr_block      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.200.0.0/22&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>authentication_options</span> {
</span></span><span style=display:flex><span>    type                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;directory-service-authentication&#34;</span>
</span></span><span style=display:flex><span>    active_directory_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_directory_service_directory</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>connection_log_options</span> {
</span></span><span style=display:flex><span>    enabled               <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    cloudwatch_log_group  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_group</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>    cloudwatch_log_stream <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_stream</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  split_tunnel <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client-vpn-ad&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=saml-authentication-sso>SAML Authentication (SSO)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_iam_saml_provider&#34; &#34;vpn&#34;</span> {
</span></span><span style=display:flex><span>  name                   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vpn-saml-provider&#34;</span>
</span></span><span style=display:flex><span>  saml_metadata_document <span style=color:#f92672>=</span> <span style=color:#66d9ef>file</span>(<span style=color:#e6db74>&#34;saml-metadata.xml&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_endpoint&#34; &#34;saml&#34;</span> {
</span></span><span style=display:flex><span>  description            <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Client VPN with SAML&#34;</span>
</span></span><span style=display:flex><span>  server_certificate_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_acm_certificate</span>.<span style=color:#66d9ef>server</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  client_cidr_block      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.200.0.0/22&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>authentication_options</span> {
</span></span><span style=display:flex><span>    type              <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;federated-authentication&#34;</span>
</span></span><span style=display:flex><span>    saml_provider_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_iam_saml_provider</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>connection_log_options</span> {
</span></span><span style=display:flex><span>    enabled               <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    cloudwatch_log_group  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_group</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>    cloudwatch_log_stream <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_stream</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  split_tunnel <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  session_timeout_hours <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client-vpn-saml&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=network-associations>Network Associations</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_network_association&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  count                  <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>)
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  subnet_id              <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  security_groups <span style=color:#f92672>=</span> [<span style=color:#66d9ef>aws_security_group</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>id</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_security_group&#34; &#34;vpn&#34;</span> {
</span></span><span style=display:flex><span>  name        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client-vpn-sg&#34;</span>
</span></span><span style=display:flex><span>  description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Security group for Client VPN&#34;</span>
</span></span><span style=display:flex><span>  vpc_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ingress</span> {
</span></span><span style=display:flex><span>    from_port   <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    to_port     <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    protocol    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;-1&#34;</span>
</span></span><span style=display:flex><span>    cidr_blocks <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;10.200.0.0/22&#34;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>egress</span> {
</span></span><span style=display:flex><span>    from_port   <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    to_port     <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    protocol    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;-1&#34;</span>
</span></span><span style=display:flex><span>    cidr_blocks <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;0.0.0.0/0&#34;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;client-vpn-sg&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=authorization-rules>Authorization Rules</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Allow access to entire VPC
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_authorization_rule&#34; &#34;vpc&#34;</span> {
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  target_network_cidr    <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>cidr_block</span>
</span></span><span style=display:flex><span>  authorize_all_groups   <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Allow internet access (if not split tunnel)
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_authorization_rule&#34; &#34;internet&#34;</span> {
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  target_network_cidr    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.0.0.0/0&#34;</span>
</span></span><span style=display:flex><span>  authorize_all_groups   <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Restrict access to specific AD group
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_authorization_rule&#34; &#34;restricted&#34;</span> {
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>ad</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  target_network_cidr    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.0.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  access_group_id        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;S-1-5-21-1234567890-1234567890-1234567890-1234&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=routes>Routes</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Route to VPC
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_route&#34; &#34;vpc&#34;</span> {
</span></span><span style=display:flex><span>  count                  <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>)
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>cidr_block</span>
</span></span><span style=display:flex><span>  target_vpc_subnet_id   <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Route to internet (for non-split tunnel)
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_client_vpn_route&#34; &#34;internet&#34;</span> {
</span></span><span style=display:flex><span>  count                  <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>)
</span></span><span style=display:flex><span>  client_vpn_endpoint_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.0.0.0/0&#34;</span>
</span></span><span style=display:flex><span>  target_vpc_subnet_id   <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=cloudwatch-logging>CloudWatch Logging</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_cloudwatch_log_group&#34; &#34;vpn&#34;</span> {
</span></span><span style=display:flex><span>  name              <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/aws/vpn/client-vpn&#34;</span>
</span></span><span style=display:flex><span>  retention_in_days <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_cloudwatch_log_stream&#34; &#34;vpn&#34;</span> {
</span></span><span style=display:flex><span>  name           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;connection-logs&#34;</span>
</span></span><span style=display:flex><span>  log_group_name <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_cloudwatch_log_group</span>.<span style=color:#66d9ef>vpn</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=vpn-monitoring>VPN Monitoring</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_cloudwatch_metric_alarm&#34; &#34;vpn_tunnel_down&#34;</span> {
</span></span><span style=display:flex><span>  alarm_name          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vpn-tunnel-down&#34;</span>
</span></span><span style=display:flex><span>  comparison_operator <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;LessThanThreshold&#34;</span>
</span></span><span style=display:flex><span>  evaluation_periods  <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  metric_name         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;TunnelState&#34;</span>
</span></span><span style=display:flex><span>  namespace           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AWS/VPN&#34;</span>
</span></span><span style=display:flex><span>  period              <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>  statistic           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Maximum&#34;</span>
</span></span><span style=display:flex><span>  threshold           <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  alarm_description   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;VPN tunnel is down&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dimensions <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    VpnId <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  alarm_actions <span style=color:#f92672>=</span> [<span style=color:#66d9ef>aws_sns_topic</span>.<span style=color:#66d9ef>alerts</span>.<span style=color:#66d9ef>arn</span>]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_cloudwatch_metric_alarm&#34; &#34;vpn_tunnel_data&#34;</span> {
</span></span><span style=display:flex><span>  alarm_name          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vpn-no-data&#34;</span>
</span></span><span style=display:flex><span>  comparison_operator <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;LessThanThreshold&#34;</span>
</span></span><span style=display:flex><span>  evaluation_periods  <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  metric_name         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;TunnelDataIn&#34;</span>
</span></span><span style=display:flex><span>  namespace           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AWS/VPN&#34;</span>
</span></span><span style=display:flex><span>  period              <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>  statistic           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sum&#34;</span>
</span></span><span style=display:flex><span>  threshold           <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  alarm_description   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;No data through VPN tunnel&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dimensions <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    VpnId <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  alarm_actions <span style=color:#f92672>=</span> [<span style=color:#66d9ef>aws_sns_topic</span>.<span style=color:#66d9ef>alerts</span>.<span style=color:#66d9ef>arn</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=outputs>Outputs</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;vpn_connection_id&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;vpn_tunnel1_address&#34;</span> {
</span></span><span style=display:flex><span>  value     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>tunnel1_address</span>
</span></span><span style=display:flex><span>  sensitive <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;vpn_tunnel1_preshared_key&#34;</span> {
</span></span><span style=display:flex><span>  value     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>tunnel1_preshared_key</span>
</span></span><span style=display:flex><span>  sensitive <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;vpn_tunnel2_address&#34;</span> {
</span></span><span style=display:flex><span>  value     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>tunnel2_address</span>
</span></span><span style=display:flex><span>  sensitive <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;vpn_tunnel2_preshared_key&#34;</span> {
</span></span><span style=display:flex><span>  value     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_connection</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>tunnel2_preshared_key</span>
</span></span><span style=display:flex><span>  sensitive <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;client_vpn_endpoint_id&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;client_vpn_dns_name&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_client_vpn_endpoint</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>dns_name</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=download-vpn-configuration>Download VPN Configuration</h2><p>After applying, download the configuration for your on-premises router:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 describe-vpn-connections <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --vpn-connection-ids vpn-1234567890abcdef0 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --query <span style=color:#e6db74>&#39;VpnConnections[0].CustomerGatewayConfiguration&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --output text &gt; vpn-config.xml
</span></span></code></pre></div><p>For Client VPN, download the client configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 export-client-vpn-client-configuration <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --client-vpn-endpoint-id cvpn-endpoint-1234567890abcdef0 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --output text &gt; client-config.ovpn
</span></span></code></pre></div></div></div><script src=/assets/shared-nav.js></script></body></html>