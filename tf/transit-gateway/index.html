<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Transit Gateway // rowstu.net</title><link rel=stylesheet href=/assets/shared-theme.css><style>.markdown-content{max-width:900px;margin:0 auto;line-height:1.7}.markdown-content h1{font-size:2.5rem;margin-bottom:1rem;color:var(--accent-teal);border-bottom:2px solid var(--border);padding-bottom:.5rem}.markdown-content h2{font-size:2rem;margin-top:2rem;margin-bottom:1rem;color:var(--accent-orange)}.markdown-content h3{font-size:1.5rem;margin-top:1.5rem;margin-bottom:.75rem;color:var(--text-primary)}.markdown-content p{margin-bottom:1rem}.markdown-content code{background:var(--bg-light);padding:.2rem .4rem;border-radius:3px;font-family:jetbrains mono,monospace;font-size:.9em}.markdown-content pre{background:var(--bg-light);padding:1rem;border-radius:6px;overflow-x:auto;margin-bottom:1rem}.markdown-content pre code{background:0 0;padding:0}.markdown-content a{color:var(--accent-teal);text-decoration:none}.markdown-content a:hover{text-decoration:underline}.markdown-content ul,.markdown-content ol{margin-bottom:1rem;padding-left:2rem}.markdown-content li{margin-bottom:.5rem}.markdown-content blockquote{border-left:4px solid var(--accent-teal);padding-left:1rem;margin:1rem 0;color:var(--text-secondary);font-style:italic}.markdown-content table{width:100%;border-collapse:collapse;margin-bottom:1rem}.markdown-content th,.markdown-content td{border:1px solid var(--border);padding:.75rem;text-align:left}.markdown-content th{background:var(--bg-light);font-weight:600}.breadcrumb{padding:1rem 0;color:var(--text-secondary);font-size:.95rem}.breadcrumb a{color:var(--accent-teal);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}</style></head><body><div class=app-header><h1 class=app-title>Transit Gateway</h1></div><div class=container><div class=breadcrumb><a href=/>Home</a> / <a href=/browse/>Browse</a>/ <a href=/tftransit-gateway/>Tftransit Gateway</a></div><div class="card markdown-content"><h1 id=transit-gateway>Transit Gateway</h1><p>Connecting multiple VPCs and on-premises networks with AWS Transit Gateway.</p><h2 id=basic-transit-gateway>Basic Transit Gateway</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  description                     <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Main Transit Gateway&#34;</span>
</span></span><span style=display:flex><span>  default_route_table_association <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  default_route_table_propagation <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  dns_support                     <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  vpn_ecmp_support                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  auto_accept_shared_attachments  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;main-tgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=vpc-attachments>VPC Attachments</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Attach Production VPC
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_vpc_attachment&#34; &#34;production&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  vpc_id             <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  subnet_ids         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>production_private</span>[<span style=color:#960050;background-color:#1e0010>*</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dns_support        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  ipv6_support       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;disable&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  transit_gateway_default_route_table_association <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  transit_gateway_default_route_table_propagation <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;production-attachment&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Attach Development VPC
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_vpc_attachment&#34; &#34;development&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  vpc_id             <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>development</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  subnet_ids         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>development_private</span>[<span style=color:#960050;background-color:#1e0010>*</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dns_support        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  ipv6_support       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;disable&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;development-attachment&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Attach Shared Services VPC
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_vpc_attachment&#34; &#34;shared&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  vpc_id             <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>shared</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  subnet_ids         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>shared_private</span>[<span style=color:#960050;background-color:#1e0010>*</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dns_support        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enable&#34;</span>
</span></span><span style=display:flex><span>  ipv6_support       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;disable&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;shared-services-attachment&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=route-tables>Route Tables</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Production Route Table
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table&#34; &#34;production&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;production-rt&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Development Route Table
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table&#34; &#34;development&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;development-rt&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=route-table-associations>Route Table Associations</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table_association&#34; &#34;production&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table_association&#34; &#34;development&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>development</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>development</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=route-table-propagations>Route Table Propagations</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Production can reach shared services
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table_propagation&#34; &#34;prod_to_shared&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>shared</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Development can reach shared services
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table_propagation&#34; &#34;dev_to_shared&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>shared</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>development</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Shared services can reach production
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route_table_propagation&#34; &#34;shared_to_prod&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>shared</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=static-routes>Static Routes</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Route to on-premises via VPN
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route&#34; &#34;to_onprem&#34;</span> {
</span></span><span style=display:flex><span>  destination_cidr_block         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;192.168.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  transit_gateway_attachment_id  <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpn_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Blackhole route (drop traffic)
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_route&#34; &#34;blackhole&#34;</span> {
</span></span><span style=display:flex><span>  destination_cidr_block         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.99.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  blackhole                      <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  transit_gateway_route_table_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_route_table</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=vpc-route-tables>VPC Route Tables</h2><p>Update VPC route tables to send traffic to Transit Gateway.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Production VPC routes
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_route&#34; &#34;production_to_tgw&#34;</span> {
</span></span><span style=display:flex><span>  count                  <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>production_private</span>)
</span></span><span style=display:flex><span>  route_table_id         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>production_private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.0.0.0/8&#34;</span>
</span></span><span style=display:flex><span>  transit_gateway_id     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  depends_on <span style=color:#f92672>=</span> [<span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>production</span>]
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Development VPC routes
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_route&#34; &#34;development_to_tgw&#34;</span> {
</span></span><span style=display:flex><span>  count                  <span style=color:#f92672>=</span> <span style=color:#66d9ef>length</span>(<span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>development_private</span>)
</span></span><span style=display:flex><span>  route_table_id         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_route_table</span>.<span style=color:#66d9ef>development_private</span>[<span style=color:#66d9ef>count</span>.<span style=color:#66d9ef>index</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  destination_cidr_block <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;10.0.0.0/8&#34;</span>
</span></span><span style=display:flex><span>  transit_gateway_id     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  depends_on <span style=color:#f92672>=</span> [<span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>development</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=cross-account-sharing>Cross-Account Sharing</h2><p>Share Transit Gateway with other AWS accounts using RAM.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ram_resource_share&#34; &#34;tgw&#34;</span> {
</span></span><span style=display:flex><span>  name                      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;transit-gateway-share&#34;</span>
</span></span><span style=display:flex><span>  allow_external_principals <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;tgw-share&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ram_resource_association&#34; &#34;tgw&#34;</span> {
</span></span><span style=display:flex><span>  resource_arn       <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>  resource_share_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ram_resource_share</span>.<span style=color:#66d9ef>tgw</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ram_principal_association&#34; &#34;tgw&#34;</span> {
</span></span><span style=display:flex><span>  principal          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;123456789012&#34;</span><span style=color:#75715e>  # Target AWS Account ID
</span></span></span><span style=display:flex><span>  resource_share_arn <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ram_resource_share</span>.<span style=color:#66d9ef>tgw</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=accepting-shared-transit-gateway-in-target-account>Accepting Shared Transit Gateway (in target account)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway&#34; &#34;shared&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>filter</span> {
</span></span><span style=display:flex><span>    name   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;owner-id&#34;</span>
</span></span><span style=display:flex><span>    values <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;111111111111&#34;</span>]<span style=color:#75715e>  # Owner account ID
</span></span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>filter</span> {
</span></span><span style=display:flex><span>    name   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;state&#34;</span>
</span></span><span style=display:flex><span>    values <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;available&#34;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_vpc_attachment&#34; &#34;from_shared&#34;</span> {
</span></span><span style=display:flex><span>  transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>data</span>.<span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>shared</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  vpc_id             <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_vpc</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  subnet_ids         <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_subnet</span>.<span style=color:#66d9ef>private</span>[<span style=color:#960050;background-color:#1e0010>*</span>].<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;attachment-to-shared-tgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=peering-cross-region>Peering (Cross-Region)</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#75715e># Transit Gateway in eu-west-2
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway&#34; &#34;london&#34;</span> {
</span></span><span style=display:flex><span>  provider    <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws</span>.<span style=color:#66d9ef>london</span>
</span></span><span style=display:flex><span>  description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;London TGW&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;london-tgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Transit Gateway in eu-west-1
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway&#34; &#34;ireland&#34;</span> {
</span></span><span style=display:flex><span>  provider    <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws</span>.<span style=color:#66d9ef>ireland</span>
</span></span><span style=display:flex><span>  description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Ireland TGW&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ireland-tgw&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Peering attachment (initiated from London)
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_peering_attachment&#34; &#34;london_to_ireland&#34;</span> {
</span></span><span style=display:flex><span>  provider                <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws</span>.<span style=color:#66d9ef>london</span>
</span></span><span style=display:flex><span>  transit_gateway_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>london</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  peer_transit_gateway_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>ireland</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>  peer_region             <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;eu-west-1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;london-to-ireland-peering&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e># Accept peering (in Ireland)
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_ec2_transit_gateway_peering_attachment_accepter&#34; &#34;ireland&#34;</span> {
</span></span><span style=display:flex><span>  provider                          <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws</span>.<span style=color:#66d9ef>ireland</span>
</span></span><span style=display:flex><span>  transit_gateway_attachment_id     <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_peering_attachment</span>.<span style=color:#66d9ef>london_to_ireland</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    Name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ireland-accepts-london&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=outputs>Outputs</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;transit_gateway_id&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;transit_gateway_arn&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway</span>.<span style=color:#66d9ef>main</span>.<span style=color:#66d9ef>arn</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;production_attachment_id&#34;</span> {
</span></span><span style=display:flex><span>  value <span style=color:#f92672>=</span> <span style=color:#66d9ef>aws_ec2_transit_gateway_vpc_attachment</span>.<span style=color:#66d9ef>production</span>.<span style=color:#66d9ef>id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><script src=/assets/shared-nav.js></script></body></html>